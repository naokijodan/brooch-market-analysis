<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ãƒ–ãƒ­ãƒ¼ãƒå¸‚å ´åˆ†æ - ãƒ–ãƒ©ãƒ³ãƒ‰åˆ¥è©³ç´°</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <style>
        :root {
            --bg-primary: #ffffff;
            --bg-secondary: #f5f5f5;
            --bg-card: #ffffff;
            --text-primary: #333333;
            --text-secondary: #666666;
            --border-color: #e0e0e0;
            --accent: #E91E63;
            --positive: #4CAF50;
            --negative: #f44336;
        }
        [data-theme="dark"] {
            --bg-primary: #1a1a2e;
            --bg-secondary: #16213e;
            --bg-card: #0f3460;
            --text-primary: #eaeaea;
            --text-secondary: #b0b0b0;
            --border-color: #3a3a5c;
        }
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
        }
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            text-align: center;
        }
        .header h1 { font-size: 1.8em; margin-bottom: 5px; }
        .header p { opacity: 0.9; font-size: 0.9em; }
        .nav-links {
            background: var(--bg-secondary);
            padding: 10px 20px;
            border-bottom: 1px solid var(--border-color);
        }
        .nav-links a {
            color: var(--accent);
            text-decoration: none;
            margin-right: 20px;
        }
        .controls {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            padding: 15px 20px;
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border-color);
            align-items: center;
        }
        .control-group {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .control-group label { font-size: 0.85em; color: var(--text-secondary); }
        .control-group input {
            width: 80px;
            padding: 6px 10px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            background: var(--bg-card);
            color: var(--text-primary);
        }
        .btn {
            padding: 8px 16px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.85em;
            transition: all 0.2s;
        }
        .btn-primary { background: var(--accent); color: white; }
        .btn-secondary { background: var(--bg-card); color: var(--text-primary); border: 1px solid var(--border-color); }
        .tabs {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            padding: 10px 20px;
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border-color);
        }
        .tab {
            padding: 10px 16px;
            border: none;
            background: transparent;
            color: var(--text-secondary);
            cursor: pointer;
            border-radius: 4px;
            font-size: 0.9em;
            transition: all 0.2s;
        }
        .tab:hover { background: var(--bg-card); }
        .tab.active { background: var(--accent); color: white; }
        .tab-content { display: none; padding: 20px; }
        .tab-content.active { display: block; }
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        .stat-card {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 15px;
            text-align: center;
        }
        .stat-card .icon { font-size: 1.5em; margin-bottom: 5px; }
        .stat-card .value { font-size: 1.6em; font-weight: bold; color: var(--accent); }
        .stat-card .label { font-size: 0.8em; color: var(--text-secondary); }
        .insight-box {
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            color: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        .insight-box h3 { margin-bottom: 10px; }
        .insight-box ul { margin-left: 20px; }
        .priority-box {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        .chart-container {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
        }
        .chart-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        .table-container {
            overflow-x: auto;
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            margin-bottom: 20px;
        }
        table { width: 100%; border-collapse: collapse; font-size: 0.85em; }
        th, td { padding: 10px 12px; text-align: left; border-bottom: 1px solid var(--border-color); }
        th { background: var(--bg-secondary); font-weight: 600; position: sticky; top: 0; }
        tr:hover { background: var(--bg-secondary); }
        .search-box { padding: 10px; background: var(--bg-secondary); }
        .search-box input {
            width: 100%;
            padding: 10px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            background: var(--bg-card);
            color: var(--text-primary);
        }
        .link-btn {
            display: inline-block;
            padding: 4px 8px;
            margin: 2px;
            font-size: 0.75em;
            border-radius: 3px;
            text-decoration: none;
            color: white;
        }
        .link-ebay { background: #0064d2; }
        .link-mercari { background: #ff0211; }
        .positive { color: var(--positive); }
        .negative { color: var(--negative); }
        .rank-badge {
            display: inline-block;
            width: 28px;
            height: 28px;
            line-height: 28px;
            text-align: center;
            border-radius: 50%;
            font-weight: bold;
            font-size: 0.85em;
        }
        .rank-1 { background: #FFD700; color: #333; }
        .rank-2 { background: #C0C0C0; color: #333; }
        .rank-3 { background: #CD7F32; color: white; }
        .rank-other { background: var(--bg-secondary); color: var(--text-primary); }
        .brand-tag {
            display: inline-block;
            padding: 3px 10px;
            border-radius: 15px;
            font-size: 0.8em;
            font-weight: 600;
            color: white;
            margin-right: 5px;
        }
        .motif-tag {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 3px;
            font-size: 0.75em;
            background: var(--bg-secondary);
            color: var(--text-primary);
            margin: 2px;
        }
        .priority-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 5px;
        }
        .priority-high { background: #4CAF50; }
        .priority-mid { background: #FF9800; }
        .priority-low { background: #9E9E9E; }
        @media (max-width: 768px) {
            .chart-grid { grid-template-columns: 1fr; }
            .controls { flex-direction: column; }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>ãƒ–ãƒ­ãƒ¼ãƒå¸‚å ´åˆ†æ - ãƒ–ãƒ©ãƒ³ãƒ‰åˆ¥è©³ç´°</h1>
        <p>ã©ã®ã‚¿ã‚¤ãƒ—ã‹ã‚‰å‡ºå“ã™ã¹ãã‹ã®åˆ¤æ–­ææ–™</p>
    </div>

    <div class="nav-links">
        <a href="index.html">â† å…¨ä½“åˆ†æã«æˆ»ã‚‹</a>
    </div>

    <div class="controls">
        <div class="control-group">
            <label>ç‚ºæ›¿:</label>
            <input type="number" id="exchangeRate" value="155" step="0.1">
            <span>å††/$</span>
            <button class="btn btn-primary" onclick="fetchExchangeRate()">æœ€æ–°å–å¾—</button>
            <span id="exchangeStatus" style="font-size:0.8em;color:var(--text-secondary);margin-left:10px;"></span>
        </div>
        <div class="control-group">
            <label>é€æ–™:</label>
            <input type="number" id="shippingCost" value="2700">
            <span>å††</span>
        </div>
        <div class="control-group">
            <label>æ‰‹æ•°æ–™:</label>
            <input type="number" id="feeRate" value="20">
            <span>%</span>
        </div>
        <button class="btn btn-primary" onclick="recalculate()">å†è¨ˆç®—</button>
        <button class="btn btn-secondary" onclick="toggleTheme()">ğŸŒ™ ãƒ†ãƒ¼ãƒ</button>
    </div>

    <div class="tabs">
        <button class="tab active" data-tab="priority">â­ å‡ºå“å„ªå…ˆé †ä½</button>
        <button class="tab" data-tab="chanel">ã‚·ãƒ£ãƒãƒ«</button>
        <button class="tab" data-tab="dior">ãƒ‡ã‚£ã‚ªãƒ¼ãƒ«</button>
        <button class="tab" data-tab="tiffany">ãƒ†ã‚£ãƒ•ã‚¡ãƒ‹ãƒ¼</button>
        <button class="tab" data-tab="mikimoto">ãƒŸã‚­ãƒ¢ãƒˆ</button>
        <button class="tab" data-tab="hermes">ã‚¨ãƒ«ãƒ¡ã‚¹</button>
        <button class="tab" data-tab="vintage">ãƒ´ã‚£ãƒ³ãƒ†ãƒ¼ã‚¸</button>
        <button class="tab" data-tab="others">ãã®ä»–ãƒ–ãƒ©ãƒ³ãƒ‰</button>
    </div>

    <!-- å‡ºå“å„ªå…ˆé †ä½ã‚¿ãƒ– -->
    <div id="tab-priority" class="tab-content active">
        <div class="priority-box">
            <h3>ğŸ“Š å‡ºå“å„ªå…ˆé †ä½ã®è¦‹æ–¹</h3>
            <ul>
                <li><strong>å„ªå…ˆã‚¹ã‚³ã‚¢</strong> = (ä»•å…¥ä¸Šé™ Ã— è²©å£²æ•°) Ã· (1 + ä¾¡æ ¼å¤‰å‹•)</li>
                <li>ã‚¹ã‚³ã‚¢ãŒé«˜ã„ã»ã©ã€Œåˆ©ç›ŠãŒå‡ºã‚„ã™ãã€å£²ã‚Œã‚„ã™ãã€ä¾¡æ ¼ãŒå®‰å®šã€</li>
                <li>åŒã˜ãƒ–ãƒ©ãƒ³ãƒ‰ã§ã‚‚<strong>ãƒ¢ãƒãƒ¼ãƒ•ãƒ»ç´ æã§å¤§ããå·®ãŒã‚ã‚‹</strong></li>
            </ul>
        </div>

        <div class="insight-box">
            <h3>ğŸ¯ æ”»ã‚æ–¹ã®çµè«–</h3>
            <ul>
                <li><strong>ã‚·ãƒ£ãƒãƒ«</strong>: ã‚³ã‚³ãƒãƒ¼ã‚¯Ã—ã‚´ãƒ¼ãƒ«ãƒ‰ãŒåœ§å€’çš„ã€‚ã‚«ãƒ¡ãƒªã‚¢Ã—ãƒ›ãƒ¯ã‚¤ãƒˆã‚‚å®‰å®š</li>
                <li><strong>ãƒ†ã‚£ãƒ•ã‚¡ãƒ‹ãƒ¼</strong>: ãƒ“ãƒ¼Ã—ã‚´ãƒ¼ãƒ«ãƒ‰ãŒé«˜å˜ä¾¡ã€‚ã‚¤ãƒãƒ§ã‚¦Ã—ã‚·ãƒ«ãƒãƒ¼ã¯å›è»¢è‰¯å¥½</li>
                <li><strong>ãƒŸã‚­ãƒ¢ãƒˆ</strong>: ãƒ‘ãƒ¼ãƒ«Ã—ã‚´ãƒ¼ãƒ«ãƒ‰ãŒé‰„æ¿ã€‚è²©å£²æ•°ãƒ»åˆ©ç›Šã¨ã‚‚ã«å„ªç§€</li>
                <li><strong>ãƒ‡ã‚£ã‚ªãƒ¼ãƒ«</strong>: ã‚´ãƒ¼ãƒ«ãƒ‰ç³»å…¨èˆ¬ãŒå®‰å®šã€‚ãƒ©ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ³ã‚‚â—</li>
                <li><strong>ãƒ´ã‚£ãƒ³ãƒ†ãƒ¼ã‚¸</strong>: ã‚·ãƒ£ãƒãƒ«Ã—ã‚´ãƒ¼ãƒ«ãƒ‰ãŒæœ€å¼·ã€‚ãƒãƒ¼ãƒ–ãƒ©ãƒ³ãƒ‰ã§ã‚‚å›è»¢â—</li>
            </ul>
        </div>

        <h3 style="margin: 20px 0 10px;">å…¨ãƒ–ãƒ©ãƒ³ãƒ‰æ¨ªæ–­ å‡ºå“å„ªå…ˆé †ä½ TOP30</h3>
        <div class="table-container">
            <table id="priority-table">
                <thead>
                    <tr>
                        <th>é †ä½</th>
                        <th>ãƒ–ãƒ©ãƒ³ãƒ‰</th>
                        <th>ãƒ¢ãƒãƒ¼ãƒ•</th>
                        <th>ç´ æ</th>
                        <th>è²©å£²æ•°</th>
                        <th>ä¸­å¤®å€¤</th>
                        <th>ä»•å…¥ä¸Šé™</th>
                        <th>ã‚¹ã‚³ã‚¢</th>
                        <th>æ¤œç´¢</th>
                    </tr>
                </thead>
                <tbody id="priority-body"></tbody>
            </table>
        </div>
    </div>

    <!-- ã‚·ãƒ£ãƒãƒ«ã‚¿ãƒ– -->
    <div id="tab-chanel" class="tab-content">
        <div class="stats-grid">
            <div class="stat-card">
                <div class="icon">ğŸ‘œ</div>
                <div class="value">378</div>
                <div class="label">ç·ã‚¢ã‚¤ãƒ†ãƒ æ•°</div>
            </div>
            <div class="stat-card">
                <div class="icon">ğŸ’°</div>
                <div class="value">$400</div>
                <div class="label">ã‚³ã‚³ãƒãƒ¼ã‚¯ä¸­å¤®å€¤</div>
            </div>
            <div class="stat-card">
                <div class="icon">ğŸ¯</div>
                <div class="value">ã‚´ãƒ¼ãƒ«ãƒ‰</div>
                <div class="label">æœ€å„ªå…ˆç´ æ</div>
            </div>
        </div>

        <div class="insight-box">
            <h3>ã‚·ãƒ£ãƒãƒ«æ”»ç•¥ãƒã‚¤ãƒ³ãƒˆ</h3>
            <ul>
                <li><strong>1ä½: ã‚³ã‚³ãƒãƒ¼ã‚¯Ã—ã‚´ãƒ¼ãƒ«ãƒ‰</strong> - 121ä»¶/$400 â†’ åœ§å€’çš„ã«ç‹™ã„ç›®</li>
                <li><strong>2ä½: ã‚«ãƒ¡ãƒªã‚¢Ã—ãƒ›ãƒ¯ã‚¤ãƒˆ</strong> - 38ä»¶/$172 â†’ å›è»¢è‰¯å¥½</li>
                <li><strong>3ä½: ãƒ©ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ³Ã—ã‚´ãƒ¼ãƒ«ãƒ‰</strong> - 31ä»¶/$348 â†’ é«˜å˜ä¾¡</li>
                <li>ãƒ‘ãƒ¼ãƒ«ç³»ã¯é«˜å˜ä¾¡ã ãŒä¾¡æ ¼å¤‰å‹•å¤§ãã‚</li>
            </ul>
        </div>

        <div class="chart-container">
            <div id="chartChanelMotif"></div>
        </div>

        <div class="table-container">
            <div class="search-box">
                <input type="text" placeholder="ğŸ” ãƒ¢ãƒãƒ¼ãƒ•ãƒ»ç´ æã§æ¤œç´¢..." onkeyup="filterTable(this, 'chanel-table')">
            </div>
            <table id="chanel-table">
                <thead>
                    <tr>
                        <th>å„ªå…ˆåº¦</th>
                        <th>ãƒ¢ãƒãƒ¼ãƒ•</th>
                        <th>ç´ æ</th>
                        <th>è²©å£²æ•°</th>
                        <th>æœ€ä½</th>
                        <th>æœ€é«˜</th>
                        <th>ä¸­å¤®å€¤</th>
                        <th>ä»•å…¥ä¸Šé™</th>
                        <th>æ¤œç´¢</th>
                    </tr>
                </thead>
                <tbody id="chanel-body"></tbody>
            </table>
        </div>
    </div>

    <!-- ãƒ‡ã‚£ã‚ªãƒ¼ãƒ«ã‚¿ãƒ– -->
    <div id="tab-dior" class="tab-content">
        <div class="stats-grid">
            <div class="stat-card">
                <div class="icon">ğŸŒŸ</div>
                <div class="value">91</div>
                <div class="label">ç·ã‚¢ã‚¤ãƒ†ãƒ æ•°</div>
            </div>
            <div class="stat-card">
                <div class="icon">ğŸ’°</div>
                <div class="value">$145</div>
                <div class="label">ã‚´ãƒ¼ãƒ«ãƒ‰ä¸­å¤®å€¤</div>
            </div>
        </div>

        <div class="insight-box">
            <h3>ãƒ‡ã‚£ã‚ªãƒ¼ãƒ«æ”»ç•¥ãƒã‚¤ãƒ³ãƒˆ</h3>
            <ul>
                <li><strong>ã‚´ãƒ¼ãƒ«ãƒ‰ç³»</strong>ãŒå®‰å®šï¼ˆ26ä»¶/$145ï¼‰</li>
                <li><strong>ãƒ©ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ³Ã—ã‚´ãƒ¼ãƒ«ãƒ‰</strong>ã‚‚å„ªç§€ï¼ˆ13ä»¶/$150ï¼‰</li>
                <li><strong>ãƒ•ãƒ©ãƒ¯ãƒ¼Ã—ã‚´ãƒ¼ãƒ«ãƒ‰</strong>ã¯å˜ä¾¡ã‚„ã‚„é«˜ã‚ï¼ˆ$179ï¼‰</li>
                <li>ãƒãƒ™ãƒ«ãƒ†ã‚£ãƒ”ãƒ³ãƒãƒƒã‚¸ã‚‚ä¸€å®šéœ€è¦ã‚ã‚Š</li>
            </ul>
        </div>

        <div class="table-container">
            <table id="dior-table">
                <thead>
                    <tr>
                        <th>å„ªå…ˆåº¦</th>
                        <th>ãƒ¢ãƒãƒ¼ãƒ•</th>
                        <th>ç´ æ</th>
                        <th>è²©å£²æ•°</th>
                        <th>ä¸­å¤®å€¤</th>
                        <th>ä»•å…¥ä¸Šé™</th>
                        <th>æ¤œç´¢</th>
                    </tr>
                </thead>
                <tbody id="dior-body"></tbody>
            </table>
        </div>
    </div>

    <!-- ãƒ†ã‚£ãƒ•ã‚¡ãƒ‹ãƒ¼ã‚¿ãƒ– -->
    <div id="tab-tiffany" class="tab-content">
        <div class="stats-grid">
            <div class="stat-card">
                <div class="icon">ğŸ’</div>
                <div class="value">87</div>
                <div class="label">ç·ã‚¢ã‚¤ãƒ†ãƒ æ•°</div>
            </div>
            <div class="stat-card">
                <div class="icon">ğŸ</div>
                <div class="value">$2,076</div>
                <div class="label">ãƒ“ãƒ¼ä¸­å¤®å€¤</div>
            </div>
        </div>

        <div class="insight-box">
            <h3>ãƒ†ã‚£ãƒ•ã‚¡ãƒ‹ãƒ¼æ”»ç•¥ãƒã‚¤ãƒ³ãƒˆ</h3>
            <ul>
                <li><strong>ãƒ“ãƒ¼Ã—ã‚´ãƒ¼ãƒ«ãƒ‰</strong>ãŒè¶…é«˜å˜ä¾¡ï¼ˆ$2,076ï¼‰- è¦‹ã¤ã‘ãŸã‚‰å³ä»•å…¥ã‚Œ</li>
                <li><strong>ã‚¤ãƒãƒ§ã‚¦Ã—ã‚·ãƒ«ãƒãƒ¼</strong>ãŒå›è»¢æœ€è‰¯ï¼ˆ23ä»¶/$114ï¼‰</li>
                <li><strong>ãƒªãƒ¼ãƒ•Ã—ã‚·ãƒ«ãƒãƒ¼</strong>ã‚‚å®‰å®šï¼ˆ22ä»¶/$122ï¼‰</li>
                <li>ã‚·ãƒ«ãƒãƒ¼ç³»ã¯å˜ä¾¡æ§ãˆã‚ã ãŒå›è»¢è‰¯å¥½</li>
            </ul>
        </div>

        <div class="table-container">
            <table id="tiffany-table">
                <thead>
                    <tr>
                        <th>å„ªå…ˆåº¦</th>
                        <th>ãƒ¢ãƒãƒ¼ãƒ•</th>
                        <th>ç´ æ</th>
                        <th>è²©å£²æ•°</th>
                        <th>ä¸­å¤®å€¤</th>
                        <th>ä»•å…¥ä¸Šé™</th>
                        <th>æ¤œç´¢</th>
                    </tr>
                </thead>
                <tbody id="tiffany-body"></tbody>
            </table>
        </div>
    </div>

    <!-- ãƒŸã‚­ãƒ¢ãƒˆã‚¿ãƒ– -->
    <div id="tab-mikimoto" class="tab-content">
        <div class="stats-grid">
            <div class="stat-card">
                <div class="icon">ğŸ¦ª</div>
                <div class="value">62</div>
                <div class="label">ç·ã‚¢ã‚¤ãƒ†ãƒ æ•°</div>
            </div>
            <div class="stat-card">
                <div class="icon">ğŸ’°</div>
                <div class="value">$448</div>
                <div class="label">ãƒ‘ãƒ¼ãƒ«Ã—ã‚´ãƒ¼ãƒ«ãƒ‰ä¸­å¤®å€¤</div>
            </div>
        </div>

        <div class="insight-box">
            <h3>ãƒŸã‚­ãƒ¢ãƒˆæ”»ç•¥ãƒã‚¤ãƒ³ãƒˆ</h3>
            <ul>
                <li><strong>ãƒ‘ãƒ¼ãƒ«Ã—ã‚´ãƒ¼ãƒ«ãƒ‰</strong>ãŒåœ§å€’çš„ï¼ˆ27ä»¶/$448ï¼‰- æœ€å„ªå…ˆ</li>
                <li><strong>å‹•ç‰©ãƒ¢ãƒãƒ¼ãƒ•Ã—ã‚´ãƒ¼ãƒ«ãƒ‰</strong>ã‚‚é«˜å˜ä¾¡ï¼ˆ5ä»¶/$566ï¼‰</li>
                <li><strong>ãƒ‘ãƒ¼ãƒ«Ã—ã‚·ãƒ«ãƒãƒ¼</strong>ã¯å˜ä¾¡æ§ãˆã‚ã ãŒå›è»¢â—ï¼ˆ16ä»¶/$168ï¼‰</li>
                <li>ãƒªãƒ¼ãƒ•ãƒ»ãƒªãƒœãƒ³ãƒ¢ãƒãƒ¼ãƒ•ã‚‚å®‰å®šéœ€è¦</li>
            </ul>
        </div>

        <div class="table-container">
            <table id="mikimoto-table">
                <thead>
                    <tr>
                        <th>å„ªå…ˆåº¦</th>
                        <th>ãƒ¢ãƒãƒ¼ãƒ•</th>
                        <th>ç´ æ</th>
                        <th>è²©å£²æ•°</th>
                        <th>ä¸­å¤®å€¤</th>
                        <th>ä»•å…¥ä¸Šé™</th>
                        <th>æ¤œç´¢</th>
                    </tr>
                </thead>
                <tbody id="mikimoto-body"></tbody>
            </table>
        </div>
    </div>

    <!-- ã‚¨ãƒ«ãƒ¡ã‚¹ã‚¿ãƒ– -->
    <div id="tab-hermes" class="tab-content">
        <div class="stats-grid">
            <div class="stat-card">
                <div class="icon">ğŸ´</div>
                <div class="value">51</div>
                <div class="label">ç·ã‚¢ã‚¤ãƒ†ãƒ æ•°</div>
            </div>
            <div class="stat-card">
                <div class="icon">ğŸ’°</div>
                <div class="value">$144</div>
                <div class="label">ã‚´ãƒ¼ãƒ«ãƒ‰ä¸­å¤®å€¤</div>
            </div>
        </div>

        <div class="insight-box">
            <h3>ã‚¨ãƒ«ãƒ¡ã‚¹æ”»ç•¥ãƒã‚¤ãƒ³ãƒˆ</h3>
            <ul>
                <li><strong>é¦¬å…·ãƒ¢ãƒãƒ¼ãƒ•</strong>ãŒé«˜å˜ä¾¡ï¼ˆ$585ï¼‰- è¦‹ã¤ã‘ãŸã‚‰ãƒãƒ£ãƒ³ã‚¹</li>
                <li><strong>ã‚´ãƒ¼ãƒ«ãƒ‰ç³»å…¨èˆ¬</strong>ãŒå®‰å®šï¼ˆ25ä»¶/$144ï¼‰</li>
                <li>Hãƒ­ã‚´ã¯æ„å¤–ã¨å˜ä¾¡ä½ã‚</li>
            </ul>
        </div>

        <div class="table-container">
            <table id="hermes-table">
                <thead>
                    <tr>
                        <th>å„ªå…ˆåº¦</th>
                        <th>ãƒ¢ãƒãƒ¼ãƒ•</th>
                        <th>ç´ æ</th>
                        <th>è²©å£²æ•°</th>
                        <th>ä¸­å¤®å€¤</th>
                        <th>ä»•å…¥ä¸Šé™</th>
                        <th>æ¤œç´¢</th>
                    </tr>
                </thead>
                <tbody id="hermes-body"></tbody>
            </table>
        </div>
    </div>

    <!-- ãƒ´ã‚£ãƒ³ãƒ†ãƒ¼ã‚¸ã‚¿ãƒ– -->
    <div id="tab-vintage" class="tab-content">
        <div class="stats-grid">
            <div class="stat-card">
                <div class="icon">ğŸ›ï¸</div>
                <div class="value">167</div>
                <div class="label">ãƒ´ã‚£ãƒ³ãƒ†ãƒ¼ã‚¸ç·æ•°</div>
            </div>
            <div class="stat-card">
                <div class="icon">ğŸ¯</div>
                <div class="value">ã‚·ãƒ£ãƒãƒ«</div>
                <div class="label">æœ€å„ªå…ˆãƒ–ãƒ©ãƒ³ãƒ‰</div>
            </div>
        </div>

        <div class="insight-box">
            <h3>ãƒ´ã‚£ãƒ³ãƒ†ãƒ¼ã‚¸æ”»ç•¥ãƒã‚¤ãƒ³ãƒˆ</h3>
            <ul>
                <li><strong>ã‚·ãƒ£ãƒãƒ«Ã—ã‚´ãƒ¼ãƒ«ãƒ‰</strong>ãŒåœ§å€’çš„ï¼ˆ78ä»¶/$387ï¼‰</li>
                <li><strong>ãƒãƒ¼ãƒ–ãƒ©ãƒ³ãƒ‰</strong>ã§ã‚‚å›è»¢è‰¯å¥½ï¼ˆ123ä»¶/$92ï¼‰- ä½å˜ä¾¡ã ãŒæ•°ã§ç¨¼ã’ã‚‹</li>
                <li>ãƒŸãƒªã‚¢ãƒ ãƒã‚¹ã‚±ãƒ«ã€ã‚¸ãƒãƒ³ã‚·ãƒ¼ç­‰ã®ãƒ´ã‚£ãƒ³ãƒ†ãƒ¼ã‚¸ãƒ–ãƒ©ãƒ³ãƒ‰ã‚‚ç‹™ã„ç›®</li>
                <li>ã‚¢ãƒ¼ãƒ«ãƒ‡ã‚³ã€ãƒ©ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ³ç³»ã¯ä¸€å®šéœ€è¦ã‚ã‚Š</li>
            </ul>
        </div>

        <div class="table-container">
            <table id="vintage-table">
                <thead>
                    <tr>
                        <th>å„ªå…ˆåº¦</th>
                        <th>ãƒ–ãƒ©ãƒ³ãƒ‰</th>
                        <th>ç´ æ</th>
                        <th>è²©å£²æ•°</th>
                        <th>ä¸­å¤®å€¤</th>
                        <th>ä»•å…¥ä¸Šé™</th>
                        <th>æ¤œç´¢</th>
                    </tr>
                </thead>
                <tbody id="vintage-body"></tbody>
            </table>
        </div>
    </div>

    <!-- ãã®ä»–ãƒ–ãƒ©ãƒ³ãƒ‰ã‚¿ãƒ– -->
    <div id="tab-others" class="tab-content">
        <div class="insight-box">
            <h3>ãã®ä»–æ³¨ç›®ãƒ–ãƒ©ãƒ³ãƒ‰</h3>
            <ul>
                <li><strong>ã‚°ãƒƒãƒ</strong>: ãƒªãƒœãƒ³ãƒ¢ãƒãƒ¼ãƒ•ãŒæ„å¤–ã¨å„ªç§€ï¼ˆ7ä»¶/$250ï¼‰</li>
                <li><strong>ãƒ«ã‚¤ãƒ´ã‚£ãƒˆãƒ³</strong>: ãƒ‘ãƒ¼ãƒ«Ã—ã‚´ãƒ¼ãƒ«ãƒ‰ãŒé«˜å˜ä¾¡ï¼ˆ$1,214ï¼‰</li>
                <li><strong>ã‚«ãƒ«ãƒ†ã‚£ã‚¨</strong>: è¶…é«˜å˜ä¾¡ï¼ˆ$1,908ï¼‰ã ãŒå‡ºå“æ•°å°‘ãªã‚</li>
                <li><strong>ãƒ´ã‚¡ãƒ³ã‚¯ãƒªãƒ¼ãƒ•</strong>: å‹•ç‰©ãƒ¢ãƒãƒ¼ãƒ•ãŒè¶…é«˜å˜ä¾¡ï¼ˆ$8,420ï¼‰</li>
                <li><strong>ãƒ•ã‚§ãƒ©ã‚¬ãƒ¢</strong>: ãƒ´ã‚¡ãƒ©ãƒ»ã‚¬ãƒ³ãƒãƒ¼ãƒ‹ã¯æ§ãˆã‚ãªå˜ä¾¡</li>
                <li><strong>ã‚¹ãƒ¯ãƒ­ãƒ•ã‚¹ã‚­ãƒ¼</strong>: ã‚¯ãƒªã‚¹ã‚¿ãƒ«ç³»ãŒå®‰å®š</li>
            </ul>
        </div>

        <h3 style="margin: 20px 0 10px;">ã‚°ãƒƒãƒ</h3>
        <div class="table-container">
            <table id="gucci-table">
                <thead>
                    <tr><th>ãƒ¢ãƒãƒ¼ãƒ•</th><th>ç´ æ</th><th>è²©å£²æ•°</th><th>ä¸­å¤®å€¤</th><th>ä»•å…¥ä¸Šé™</th></tr>
                </thead>
                <tbody id="gucci-body"></tbody>
            </table>
        </div>

        <h3 style="margin: 20px 0 10px;">ãƒ«ã‚¤ãƒ´ã‚£ãƒˆãƒ³</h3>
        <div class="table-container">
            <table id="lv-table">
                <thead>
                    <tr><th>ãƒ¢ãƒãƒ¼ãƒ•</th><th>ç´ æ</th><th>è²©å£²æ•°</th><th>ä¸­å¤®å€¤</th><th>ä»•å…¥ä¸Šé™</th></tr>
                </thead>
                <tbody id="lv-body"></tbody>
            </table>
        </div>

        <h3 style="margin: 20px 0 10px;">ãƒ•ã‚§ãƒ©ã‚¬ãƒ¢</h3>
        <div class="table-container">
            <table id="ferragamo-table">
                <thead>
                    <tr><th>ãƒ¢ãƒãƒ¼ãƒ•</th><th>ç´ æ</th><th>è²©å£²æ•°</th><th>ä¸­å¤®å€¤</th><th>ä»•å…¥ä¸Šé™</th></tr>
                </thead>
                <tbody id="ferragamo-body"></tbody>
            </table>
        </div>
    </div>

    <script>
        // ãƒ–ãƒ©ãƒ³ãƒ‰ãƒ‡ãƒ¼ã‚¿
        const brandData = {
            chanel: [
                {motif: 'ã‚³ã‚³ãƒãƒ¼ã‚¯', material: 'ã‚´ãƒ¼ãƒ«ãƒ‰', total_sales: 121, median_price: 400, min_price: 50, max_price: 1259, breakeven: 46900, priority_score: 1418725},
                {motif: 'ã‚«ãƒ¡ãƒªã‚¢', material: 'ãƒ›ãƒ¯ã‚¤ãƒˆ', total_sales: 38, median_price: 172, min_price: 80, max_price: 350, breakeven: 18628, priority_score: 351378},
                {motif: 'ã‚³ã‚³ãƒãƒ¼ã‚¯', material: 'ã‚·ãƒ«ãƒãƒ¼', total_sales: 15, median_price: 448.56, min_price: 150, max_price: 750, breakeven: 52921, priority_score: 336061},
                {motif: 'ãƒãƒ¼ãƒˆ', material: 'ã‚´ãƒ¼ãƒ«ãƒ‰', total_sales: 7, median_price: 750, min_price: 400, max_price: 1200, breakeven: 90300, priority_score: 319443},
                {motif: 'ãƒ©ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ³', material: 'ã‚´ãƒ¼ãƒ«ãƒ‰', total_sales: 31, median_price: 348, min_price: 100, max_price: 800, breakeven: 40452, priority_score: 313503},
                {motif: 'ãƒãƒˆãƒ©ãƒƒã‚»', material: 'ã‚´ãƒ¼ãƒ«ãƒ‰', total_sales: 13, median_price: 445, min_price: 200, max_price: 700, breakeven: 52480, priority_score: 269146},
                {motif: 'ãã®ä»–', material: 'ã‚´ãƒ¼ãƒ«ãƒ‰', total_sales: 28, median_price: 283.65, min_price: 80, max_price: 600, breakeven: 32473, priority_score: 268608},
                {motif: 'ã‚³ã‚³ãƒãƒ¼ã‚¯', material: 'ä¸æ˜', total_sales: 34, median_price: 267.5, min_price: 50, max_price: 800, breakeven: 30470, priority_score: 258995},
                {motif: 'ãƒ‘ãƒ¼ãƒ«', material: 'ã‚´ãƒ¼ãƒ«ãƒ‰', total_sales: 21, median_price: 400, min_price: 145, max_price: 4662, breakeven: 46900, priority_score: 246225},
                {motif: 'ã‚«ãƒ¡ãƒªã‚¢', material: 'ä¸æ˜', total_sales: 45, median_price: 189, min_price: 80, max_price: 500, breakeven: 20736, priority_score: 233280},
                {motif: 'å‹•ç‰©', material: 'ã‚´ãƒ¼ãƒ«ãƒ‰', total_sales: 6, median_price: 625.98, min_price: 300, max_price: 950, breakeven: 74921, priority_score: 228905},
                {motif: 'ã‚¨ãƒŠãƒ¡ãƒ«', material: 'ã‚´ãƒ¼ãƒ«ãƒ‰', total_sales: 4, median_price: 891.3, min_price: 400, max_price: 1500, breakeven: 107821, priority_score: 211933},
                {motif: 'ã‚¯ãƒ­ã‚¹', material: 'ã‚´ãƒ¼ãƒ«ãƒ‰', total_sales: 4, median_price: 700, min_price: 350, max_price: 1100, breakeven: 84100, priority_score: 199433},
                {motif: 'ãƒ•ãƒ©ãƒ¯ãƒ¼', material: 'ã‚´ãƒ¼ãƒ«ãƒ‰', total_sales: 15, median_price: 189, min_price: 80, max_price: 400, breakeven: 20737, priority_score: 185571},
                {motif: 'ãƒãƒ™ãƒ«ãƒ†ã‚£', material: 'ã‚´ãƒ¼ãƒ«ãƒ‰', total_sales: 8, median_price: 230, min_price: 100, max_price: 400, breakeven: 25820, priority_score: 145678},
            ],
            dior: [
                {motif: 'ãã®ä»–', material: 'ã‚´ãƒ¼ãƒ«ãƒ‰', total_sales: 26, median_price: 144.5, min_price: 22, max_price: 390, breakeven: 15218, priority_score: 114006},
                {motif: 'ãƒ©ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ³', material: 'ã‚´ãƒ¼ãƒ«ãƒ‰', total_sales: 13, median_price: 150, min_price: 50, max_price: 300, breakeven: 15899, priority_score: 72857},
                {motif: 'ãƒ•ãƒ©ãƒ¯ãƒ¼', material: 'ã‚´ãƒ¼ãƒ«ãƒ‰', total_sales: 7, median_price: 179, min_price: 80, max_price: 280, breakeven: 19496, priority_score: 67294},
                {motif: 'ã‚¯ãƒªã‚¹ã‚¿ãƒ«', material: 'ã‚´ãƒ¼ãƒ«ãƒ‰', total_sales: 2, median_price: 269.9, min_price: 200, max_price: 350, breakeven: 30767, priority_score: 50310},
                {motif: 'ãƒ“ãƒ¼', material: 'ã‚´ãƒ¼ãƒ«ãƒ‰', total_sales: 2, median_price: 229.9, min_price: 150, max_price: 310, breakeven: 25807, priority_score: 47523},
                {motif: 'ãƒ‘ãƒ¼ãƒ«', material: 'ã‚´ãƒ¼ãƒ«ãƒ‰', total_sales: 5, median_price: 120, min_price: 60, max_price: 200, breakeven: 12180, priority_score: 32624},
                {motif: 'ã‚¹ã‚¿ãƒ¼', material: 'ã‚´ãƒ¼ãƒ«ãƒ‰', total_sales: 3, median_price: 135, min_price: 80, max_price: 200, breakeven: 13998, priority_score: 28500},
            ],
            tiffany: [
                {motif: 'ãƒ“ãƒ¼', material: 'ã‚´ãƒ¼ãƒ«ãƒ‰', total_sales: 2, median_price: 2075.62, min_price: 1800, max_price: 2350, breakeven: 254677, priority_score: 501973},
                {motif: 'é³¥', material: 'ã‚´ãƒ¼ãƒ«ãƒ‰', total_sales: 1, median_price: 2076.75, min_price: 2076, max_price: 2077, breakeven: 254817, priority_score: 254817},
                {motif: 'å‹•ç‰©', material: 'ã‚·ãƒ«ãƒãƒ¼', total_sales: 6, median_price: 300.3, min_price: 150, max_price: 500, breakeven: 34537, priority_score: 165759},
                {motif: 'ãƒªãƒ¼ãƒ•', material: 'ã‚·ãƒ«ãƒãƒ¼', total_sales: 22, median_price: 122.33, min_price: 80, max_price: 200, breakeven: 12469, priority_score: 164021},
                {motif: 'ã‚¤ãƒãƒ§ã‚¦', material: 'ã‚·ãƒ«ãƒãƒ¼', total_sales: 23, median_price: 113.75, min_price: 88, max_price: 180, breakeven: 11404, priority_score: 160747},
                {motif: 'ãã®ä»–', material: 'ã‚·ãƒ«ãƒãƒ¼', total_sales: 21, median_price: 215.82, min_price: 100, max_price: 400, breakeven: 24062, priority_score: 126324},
                {motif: 'ãã®ä»–', material: 'ã‚´ãƒ¼ãƒ«ãƒ‰', total_sales: 8, median_price: 390, min_price: 200, max_price: 600, breakeven: 45660, priority_score: 91320},
                {motif: 'ãƒ“ãƒ¼', material: 'ã‚·ãƒ«ãƒãƒ¼', total_sales: 3, median_price: 328, min_price: 250, max_price: 420, breakeven: 37972, priority_score: 87710},
                {motif: 'ãƒ•ãƒ©ãƒ¯ãƒ¼', material: 'ã‚·ãƒ«ãƒãƒ¼', total_sales: 21, median_price: 139.5, min_price: 80, max_price: 250, breakeven: 14598, priority_score: 76640},
            ],
            mikimoto: [
                {motif: 'ãƒ‘ãƒ¼ãƒ«', material: 'ã‚´ãƒ¼ãƒ«ãƒ‰', total_sales: 27, median_price: 447.5, min_price: 190, max_price: 1550, breakeven: 52790, priority_score: 356333},
                {motif: 'ãã®ä»–', material: 'ã‚´ãƒ¼ãƒ«ãƒ‰', total_sales: 2, median_price: 1041.36, min_price: 800, max_price: 1280, breakeven: 126429, priority_score: 144153},
                {motif: 'ãƒ‘ãƒ¼ãƒ«', material: 'ä¸æ˜', total_sales: 8, median_price: 336, min_price: 200, max_price: 500, breakeven: 38964, priority_score: 101382},
                {motif: 'ãƒªãƒ¼ãƒ•', material: 'ã‚´ãƒ¼ãƒ«ãƒ‰', total_sales: 2, median_price: 513.5, min_price: 400, max_price: 630, breakeven: 60974, priority_score: 100919},
                {motif: 'ãƒªãƒœãƒ³', material: 'ã‚´ãƒ¼ãƒ«ãƒ‰', total_sales: 2, median_price: 467.5, min_price: 350, max_price: 585, breakeven: 55270, priority_score: 97047},
                {motif: 'å‹•ç‰©', material: 'ã‚´ãƒ¼ãƒ«ãƒ‰', total_sales: 5, median_price: 565.58, min_price: 400, max_price: 780, breakeven: 67432, priority_score: 84290},
                {motif: 'ãƒ‘ãƒ¼ãƒ«', material: 'ã‚·ãƒ«ãƒãƒ¼', total_sales: 16, median_price: 167.85, min_price: 80, max_price: 300, breakeven: 18113, priority_score: 72454},
                {motif: 'ãƒ•ãƒ©ãƒ¯ãƒ¼', material: 'ã‚´ãƒ¼ãƒ«ãƒ‰', total_sales: 1, median_price: 460, min_price: 460, max_price: 460, breakeven: 54340, priority_score: 54340},
            ],
            hermes: [
                {motif: 'é¦¬å…·ãƒ¢ãƒãƒ¼ãƒ•', material: 'ä¸æ˜', total_sales: 3, median_price: 585, min_price: 400, max_price: 800, breakeven: 69840, priority_score: 131271},
                {motif: 'ãã®ä»–', material: 'ã‚´ãƒ¼ãƒ«ãƒ‰', total_sales: 25, median_price: 143.93, min_price: 52, max_price: 390, breakeven: 15147, priority_score: 113095},
                {motif: 'ãã®ä»–', material: 'ã‚·ãƒ«ãƒãƒ¼', total_sales: 7, median_price: 198, min_price: 100, max_price: 320, breakeven: 21852, priority_score: 80337},
                {motif: 'é¦¬å…·ãƒ¢ãƒãƒ¼ãƒ•', material: 'ã‚´ãƒ¼ãƒ«ãƒ‰', total_sales: 2, median_price: 226.69, min_price: 180, max_price: 280, breakeven: 25410, priority_score: 35993},
                {motif: 'å‹•ç‰©', material: 'ä¸æ˜', total_sales: 2, median_price: 224.5, min_price: 180, max_price: 270, breakeven: 25138, priority_score: 33642},
                {motif: 'Hãƒ­ã‚´', material: 'ã‚´ãƒ¼ãƒ«ãƒ‰', total_sales: 1, median_price: 138.48, min_price: 138, max_price: 139, breakeven: 14472, priority_score: 14472},
            ],
            vintage: [
                {brand: 'ã‚·ãƒ£ãƒãƒ«', material: 'ã‚´ãƒ¼ãƒ«ãƒ‰', total_sales: 78, median_price: 386.5, breakeven: 45226, priority_score: 881907},
                {brand: 'ã‚«ãƒ«ãƒ†ã‚£ã‚¨', material: 'ã‚´ãƒ¼ãƒ«ãƒ‰', total_sales: 2, median_price: 1908.44, breakeven: 233947, priority_score: 467893},
                {brand: 'ãƒ´ã‚¡ãƒ³ã‚¯ãƒªãƒ¼ãƒ•', material: 'ã‚´ãƒ¼ãƒ«ãƒ‰', total_sales: 1, median_price: 2632.21, breakeven: 323694, priority_score: 323694},
                {brand: 'ãƒãƒ¼ãƒ–ãƒ©ãƒ³ãƒ‰', material: 'ä¸æ˜', total_sales: 123, median_price: 92.5, breakeven: 8769, priority_score: 269658},
                {brand: 'ãƒ‡ã‚£ã‚ªãƒ¼ãƒ«', material: 'ã‚´ãƒ¼ãƒ«ãƒ‰', total_sales: 38, median_price: 171.75, breakeven: 18597, priority_score: 229548},
                {brand: 'ã‚·ãƒ£ãƒãƒ«', material: 'ãƒ›ãƒ¯ã‚¤ãƒˆ', total_sales: 16, median_price: 180, breakeven: 19621, priority_score: 159410},
                {brand: 'ã‚·ãƒ£ãƒãƒ«', material: 'ä¸æ˜', total_sales: 33, median_price: 175, breakeven: 19000, priority_score: 156750},
                {brand: 'ãƒãƒ¼ãƒ–ãƒ©ãƒ³ãƒ‰', material: 'ã‚·ãƒ«ãƒãƒ¼', total_sales: 60, median_price: 96, breakeven: 9204, priority_score: 138060},
                {brand: 'ãƒŸãƒªã‚¢ãƒ ãƒã‚¹ã‚±ãƒ«', material: 'ä¸æ˜', total_sales: 2, median_price: 569, breakeven: 67856, priority_score: 135712},
                {brand: 'ãƒ†ã‚£ãƒ•ã‚¡ãƒ‹ãƒ¼', material: 'ã‚·ãƒ«ãƒãƒ¼', total_sales: 17, median_price: 272.88, breakeven: 31137, priority_score: 132333},
                {brand: 'ãƒãƒ¼ãƒ–ãƒ©ãƒ³ãƒ‰', material: 'ã‚´ãƒ¼ãƒ«ãƒ‰', total_sales: 35, median_price: 105.4, breakeven: 10370, priority_score: 90734},
            ],
            gucci: [
                {motif: 'ãƒªãƒœãƒ³', material: 'ä¸æ˜', total_sales: 7, median_price: 250, breakeven: 28300, priority_score: 131314},
                {motif: 'GGãƒ­ã‚´', material: 'ã‚´ãƒ¼ãƒ«ãƒ‰', total_sales: 4, median_price: 186.5, breakeven: 20426, priority_score: 40759},
                {motif: 'ãƒ‘ãƒ¼ãƒ«', material: 'ä¸æ˜', total_sales: 1, median_price: 250, breakeven: 28300, priority_score: 28300},
                {motif: 'ãƒ“ãƒ¼', material: 'ãƒãƒ«ãƒã‚«ãƒ©ãƒ¼', total_sales: 1, median_price: 213.58, breakeven: 23784, priority_score: 23784},
            ],
            lv: [
                {motif: 'ãƒ‘ãƒ¼ãƒ«', material: 'ã‚´ãƒ¼ãƒ«ãƒ‰', total_sales: 1, median_price: 1213.72, breakeven: 147801, priority_score: 147801},
                {motif: 'ãã®ä»–', material: 'ä¸æ˜', total_sales: 7, median_price: 260, breakeven: 29540, priority_score: 88136},
                {motif: 'å‹•ç‰©', material: 'ä¸æ˜', total_sales: 1, median_price: 700, breakeven: 84100, priority_score: 84100},
                {motif: 'ãƒ•ãƒ©ãƒ¯ãƒ¼', material: 'ãƒãƒ«ãƒã‚«ãƒ©ãƒ¼', total_sales: 2, median_price: 242.19, breakeven: 27332, priority_score: 51599},
            ],
            ferragamo: [
                {motif: 'ãƒ´ã‚¡ãƒ©', material: 'ã‚´ãƒ¼ãƒ«ãƒ‰', total_sales: 1, median_price: 89, breakeven: 8336, priority_score: 8336},
                {motif: 'ãƒ‘ãƒ¼ãƒ«', material: 'ã‚´ãƒ¼ãƒ«ãƒ‰', total_sales: 1, median_price: 72, breakeven: 6228, priority_score: 6228},
                {motif: 'ã‚¬ãƒ³ãƒãƒ¼ãƒ‹', material: 'ä¸æ˜', total_sales: 1, median_price: 40, breakeven: 2260, priority_score: 2260},
            ]
        };

        // å…¨ãƒ–ãƒ©ãƒ³ãƒ‰æ¨ªæ–­å„ªå…ˆé †ä½
        const priorityRanking = [
            {rank: 1, brand: 'ã‚·ãƒ£ãƒãƒ«', category: 'ãƒã‚¤ãƒ–ãƒ©ãƒ³ãƒ‰', motif: 'ã‚³ã‚³ãƒãƒ¼ã‚¯', material: 'ã‚´ãƒ¼ãƒ«ãƒ‰', total_sales: 121, median_price: 400, breakeven: 46900, priority_score: 1418725},
            {rank: 2, brand: 'ãƒ´ã‚¡ãƒ³ã‚¯ãƒªãƒ¼ãƒ•', category: 'ãƒã‚¤ãƒ–ãƒ©ãƒ³ãƒ‰', motif: 'å‹•ç‰©', material: 'ã‚´ãƒ¼ãƒ«ãƒ‰', total_sales: 1, median_price: 8420, breakeven: 1041380, priority_score: 1041380},
            {rank: 3, brand: 'ã‚·ãƒ£ãƒãƒ«', category: 'ãƒ´ã‚£ãƒ³ãƒ†ãƒ¼ã‚¸', motif: '-', material: 'ã‚´ãƒ¼ãƒ«ãƒ‰', total_sales: 78, median_price: 386.5, breakeven: 45226, priority_score: 881907},
            {rank: 4, brand: 'ãƒ–ãƒ«ã‚¬ãƒª', category: 'ãƒã‚¤ãƒ–ãƒ©ãƒ³ãƒ‰', motif: 'ãã®ä»–', material: 'ã‚´ãƒ¼ãƒ«ãƒ‰', total_sales: 1, median_price: 4314, breakeven: 532236, priority_score: 532236},
            {rank: 5, brand: 'ãƒ†ã‚£ãƒ•ã‚¡ãƒ‹ãƒ¼', category: 'ãƒã‚¤ãƒ–ãƒ©ãƒ³ãƒ‰', motif: 'ãƒ“ãƒ¼', material: 'ã‚´ãƒ¼ãƒ«ãƒ‰', total_sales: 2, median_price: 2075.62, breakeven: 254677, priority_score: 501973},
            {rank: 6, brand: 'ã‚«ãƒ«ãƒ†ã‚£ã‚¨', category: 'ãƒ´ã‚£ãƒ³ãƒ†ãƒ¼ã‚¸', motif: '-', material: 'ã‚´ãƒ¼ãƒ«ãƒ‰', total_sales: 2, median_price: 1908.44, breakeven: 233947, priority_score: 467893},
            {rank: 7, brand: 'ãƒ´ã‚¡ãƒ³ã‚¯ãƒªãƒ¼ãƒ•', category: 'ãƒã‚¤ãƒ–ãƒ©ãƒ³ãƒ‰', motif: 'ãã®ä»–', material: 'ã‚´ãƒ¼ãƒ«ãƒ‰', total_sales: 2, median_price: 2281.51, breakeven: 280207, priority_score: 428636},
            {rank: 8, brand: 'ãƒŸã‚­ãƒ¢ãƒˆ', category: 'ãƒ‡ã‚¶ã‚¤ãƒŠãƒ¼', motif: 'ãƒ‘ãƒ¼ãƒ«', material: 'ã‚´ãƒ¼ãƒ«ãƒ‰', total_sales: 27, median_price: 447.5, breakeven: 52790, priority_score: 356333},
            {rank: 9, brand: 'ã‚·ãƒ£ãƒãƒ«', category: 'ãƒã‚¤ãƒ–ãƒ©ãƒ³ãƒ‰', motif: 'ã‚«ãƒ¡ãƒªã‚¢', material: 'ãƒ›ãƒ¯ã‚¤ãƒˆ', total_sales: 38, median_price: 172, breakeven: 18628, priority_score: 351378},
            {rank: 10, brand: 'ã‚·ãƒ£ãƒãƒ«', category: 'ãƒã‚¤ãƒ–ãƒ©ãƒ³ãƒ‰', motif: 'ã‚³ã‚³ãƒãƒ¼ã‚¯', material: 'ã‚·ãƒ«ãƒãƒ¼', total_sales: 15, median_price: 448.56, breakeven: 52921, priority_score: 336061},
            {rank: 11, brand: 'ãƒ´ã‚¡ãƒ³ã‚¯ãƒªãƒ¼ãƒ•', category: 'ãƒ´ã‚£ãƒ³ãƒ†ãƒ¼ã‚¸', motif: '-', material: 'ã‚´ãƒ¼ãƒ«ãƒ‰', total_sales: 1, median_price: 2632.21, breakeven: 323694, priority_score: 323694},
            {rank: 12, brand: 'ã‚·ãƒ£ãƒãƒ«', category: 'ãƒã‚¤ãƒ–ãƒ©ãƒ³ãƒ‰', motif: 'ãƒãƒ¼ãƒˆ', material: 'ã‚´ãƒ¼ãƒ«ãƒ‰', total_sales: 7, median_price: 750, breakeven: 90300, priority_score: 319443},
            {rank: 13, brand: 'ã‚·ãƒ£ãƒãƒ«', category: 'ãƒã‚¤ãƒ–ãƒ©ãƒ³ãƒ‰', motif: 'ãƒ©ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ³', material: 'ã‚´ãƒ¼ãƒ«ãƒ‰', total_sales: 31, median_price: 348, breakeven: 40452, priority_score: 313503},
            {rank: 14, brand: 'ãƒãƒ¼ãƒ–ãƒ©ãƒ³ãƒ‰', category: 'ãƒ´ã‚£ãƒ³ãƒ†ãƒ¼ã‚¸', motif: '-', material: 'ä¸æ˜', total_sales: 123, median_price: 92.5, breakeven: 8769, priority_score: 269658},
            {rank: 15, brand: 'ã‚·ãƒ£ãƒãƒ«', category: 'ãƒã‚¤ãƒ–ãƒ©ãƒ³ãƒ‰', motif: 'ãƒãƒˆãƒ©ãƒƒã‚»', material: 'ã‚´ãƒ¼ãƒ«ãƒ‰', total_sales: 13, median_price: 445, breakeven: 52480, priority_score: 269146},
            {rank: 16, brand: 'ãƒ†ã‚£ãƒ•ã‚¡ãƒ‹ãƒ¼', category: 'ãƒã‚¤ãƒ–ãƒ©ãƒ³ãƒ‰', motif: 'é³¥', material: 'ã‚´ãƒ¼ãƒ«ãƒ‰', total_sales: 1, median_price: 2076.75, breakeven: 254817, priority_score: 254817},
            {rank: 17, brand: 'ã‚·ãƒ£ãƒãƒ«', category: 'ãƒã‚¤ãƒ–ãƒ©ãƒ³ãƒ‰', motif: 'ãƒ‘ãƒ¼ãƒ«', material: 'ã‚´ãƒ¼ãƒ«ãƒ‰', total_sales: 21, median_price: 400, breakeven: 46900, priority_score: 246225},
            {rank: 18, brand: 'ã‚«ãƒ«ãƒ†ã‚£ã‚¨', category: 'ãƒã‚¤ãƒ–ãƒ©ãƒ³ãƒ‰', motif: 'ã‚¨ãƒŠãƒ¡ãƒ«', material: 'ã‚´ãƒ¼ãƒ«ãƒ‰', total_sales: 1, median_price: 1908.44, breakeven: 233947, priority_score: 233947},
            {rank: 19, brand: 'ã‚·ãƒ£ãƒãƒ«', category: 'ãƒã‚¤ãƒ–ãƒ©ãƒ³ãƒ‰', motif: 'ã‚«ãƒ¡ãƒªã‚¢', material: 'ä¸æ˜', total_sales: 45, median_price: 189, breakeven: 20736, priority_score: 233280},
            {rank: 20, brand: 'ãƒ‡ã‚£ã‚ªãƒ¼ãƒ«', category: 'ãƒ´ã‚£ãƒ³ãƒ†ãƒ¼ã‚¸', motif: '-', material: 'ã‚´ãƒ¼ãƒ«ãƒ‰', total_sales: 38, median_price: 171.75, breakeven: 18597, priority_score: 229548},
        ];

        let currentExchangeRate = 155;
        let currentShipping = 2700;
        let currentFeeRate = 0.20;

        // ç‚ºæ›¿ãƒ¬ãƒ¼ãƒˆå–å¾—
        async function fetchExchangeRate() {
            const statusEl = document.getElementById('exchangeStatus');
            statusEl.textContent = 'å–å¾—ä¸­...';
            try {
                const response = await fetch('https://api.exchangerate-api.com/v4/latest/USD');
                const data = await response.json();
                const rate = data.rates.JPY;
                document.getElementById('exchangeRate').value = rate.toFixed(2);
                currentExchangeRate = rate;
                statusEl.textContent = `âœ“ ${new Date().toLocaleTimeString()}`;
                recalculate();
            } catch (error) {
                statusEl.textContent = 'å–å¾—å¤±æ•—';
            }
        }

        function calculateBreakeven(priceUsd) {
            return priceUsd * currentExchangeRate * (1 - currentFeeRate) - currentShipping;
        }

        function recalculate() {
            currentExchangeRate = parseFloat(document.getElementById('exchangeRate').value) || 155;
            currentShipping = parseFloat(document.getElementById('shippingCost').value) || 2700;
            currentFeeRate = parseFloat(document.getElementById('feeRate').value) / 100 || 0.20;
            renderAllTables();
        }

        function getPriorityIndicator(rank, total) {
            const ratio = rank / total;
            if (ratio <= 0.2) return '<span class="priority-indicator priority-high"></span>';
            if (ratio <= 0.5) return '<span class="priority-indicator priority-mid"></span>';
            return '<span class="priority-indicator priority-low"></span>';
        }

        function renderBrandTable(data, bodyId, hasBrand = false) {
            const tbody = document.getElementById(bodyId);
            tbody.innerHTML = '';

            data.forEach((row, idx) => {
                const breakeven = hasBrand ? calculateBreakeven(row.median_price) : calculateBreakeven(row.median_price);
                const searchTerm = hasBrand
                    ? encodeURIComponent(`${row.brand} ãƒ–ãƒ­ãƒ¼ãƒ ${row.material}`)
                    : encodeURIComponent(`${row.motif} ãƒ–ãƒ­ãƒ¼ãƒ ${row.material}`);

                const tr = document.createElement('tr');
                if (hasBrand) {
                    tr.innerHTML = `
                        <td>${getPriorityIndicator(idx + 1, data.length)} ${idx + 1}</td>
                        <td><strong>${row.brand}</strong></td>
                        <td>${row.material}</td>
                        <td>${row.total_sales}</td>
                        <td>$${row.median_price.toFixed(0)}</td>
                        <td class="${breakeven > 0 ? 'positive' : 'negative'}">Â¥${Math.round(breakeven).toLocaleString()}</td>
                        <td><a href="https://jp.mercari.com/search?keyword=${searchTerm}&status=on_sale" target="_blank" class="link-btn link-mercari">ãƒ¡ãƒ«ã‚«ãƒª</a></td>
                    `;
                } else {
                    tr.innerHTML = `
                        <td>${getPriorityIndicator(idx + 1, data.length)} ${idx + 1}</td>
                        <td><strong>${row.motif}</strong></td>
                        <td>${row.material}</td>
                        <td>${row.total_sales}</td>
                        <td>$${row.min_price ? row.min_price.toFixed(0) : '-'}</td>
                        <td>$${row.max_price ? row.max_price.toFixed(0) : '-'}</td>
                        <td>$${row.median_price.toFixed(0)}</td>
                        <td class="${breakeven > 0 ? 'positive' : 'negative'}">Â¥${Math.round(breakeven).toLocaleString()}</td>
                        <td><a href="https://jp.mercari.com/search?keyword=${searchTerm}&status=on_sale" target="_blank" class="link-btn link-mercari">ãƒ¡ãƒ«ã‚«ãƒª</a></td>
                    `;
                }
                tbody.appendChild(tr);
            });
        }

        function renderPriorityTable() {
            const tbody = document.getElementById('priority-body');
            tbody.innerHTML = '';

            const categoryColors = {
                'ãƒã‚¤ãƒ–ãƒ©ãƒ³ãƒ‰': '#E91E63',
                'ãƒ‡ã‚¶ã‚¤ãƒŠãƒ¼': '#9C27B0',
                'ãƒ´ã‚£ãƒ³ãƒ†ãƒ¼ã‚¸': '#607D8B'
            };

            priorityRanking.forEach(row => {
                const breakeven = calculateBreakeven(row.median_price);
                const rankClass = row.rank <= 3 ? `rank-${row.rank}` : 'rank-other';
                const searchTerm = encodeURIComponent(`${row.brand} ${row.motif !== '-' ? row.motif : ''} ãƒ–ãƒ­ãƒ¼ãƒ`);

                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td><span class="rank-badge ${rankClass}">${row.rank}</span></td>
                    <td><span class="brand-tag" style="background:${categoryColors[row.category] || '#666'}">${row.brand}</span></td>
                    <td>${row.motif}</td>
                    <td>${row.material}</td>
                    <td>${row.total_sales}</td>
                    <td>$${row.median_price.toFixed(0)}</td>
                    <td class="${breakeven > 0 ? 'positive' : 'negative'}">Â¥${Math.round(breakeven).toLocaleString()}</td>
                    <td>${(row.priority_score / 10000).toFixed(0)}ä¸‡</td>
                    <td><a href="https://jp.mercari.com/search?keyword=${searchTerm}&status=on_sale" target="_blank" class="link-btn link-mercari">ãƒ¡ãƒ«ã‚«ãƒª</a></td>
                `;
                tbody.appendChild(tr);
            });
        }

        function renderSimpleTable(data, bodyId) {
            const tbody = document.getElementById(bodyId);
            tbody.innerHTML = '';

            data.forEach(row => {
                const breakeven = calculateBreakeven(row.median_price);
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${row.motif}</td>
                    <td>${row.material}</td>
                    <td>${row.total_sales}</td>
                    <td>$${row.median_price.toFixed(0)}</td>
                    <td class="${breakeven > 0 ? 'positive' : 'negative'}">Â¥${Math.round(breakeven).toLocaleString()}</td>
                `;
                tbody.appendChild(tr);
            });
        }

        function renderAllTables() {
            renderPriorityTable();
            renderBrandTable(brandData.chanel, 'chanel-body');
            renderBrandTable(brandData.dior, 'dior-body');
            renderBrandTable(brandData.tiffany, 'tiffany-body');
            renderBrandTable(brandData.mikimoto, 'mikimoto-body');
            renderBrandTable(brandData.hermes, 'hermes-body');
            renderBrandTable(brandData.vintage, 'vintage-body', true);
            renderSimpleTable(brandData.gucci, 'gucci-body');
            renderSimpleTable(brandData.lv, 'lv-body');
            renderSimpleTable(brandData.ferragamo, 'ferragamo-body');
        }

        function filterTable(input, tableId) {
            const filter = input.value.toLowerCase();
            const table = document.getElementById(tableId);
            const rows = table.getElementsByTagName('tr');
            for (let i = 1; i < rows.length; i++) {
                const text = rows[i].textContent.toLowerCase();
                rows[i].style.display = text.includes(filter) ? '' : 'none';
            }
        }

        // ã‚¿ãƒ–åˆ‡æ›¿
        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', () => {
                document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                tab.classList.add('active');
                document.getElementById('tab-' + tab.dataset.tab).classList.add('active');
            });
        });

        function toggleTheme() {
            const html = document.documentElement;
            const current = html.getAttribute('data-theme');
            const next = current === 'dark' ? 'light' : 'dark';
            html.setAttribute('data-theme', next);
            localStorage.setItem('theme', next);
            renderCharts();
        }

        function initTheme() {
            const saved = localStorage.getItem('theme');
            if (saved === 'dark') {
                document.documentElement.setAttribute('data-theme', 'dark');
            }
        }

        function renderCharts() {
            const isDark = document.documentElement.getAttribute('data-theme') === 'dark';
            const textColor = isDark ? '#eaeaea' : '#333';
            const bgColor = isDark ? '#0f3460' : '#fff';

            // ã‚·ãƒ£ãƒãƒ«ãƒ¢ãƒãƒ¼ãƒ•åˆ¥ã‚°ãƒ©ãƒ•
            const chanelMotifs = brandData.chanel.slice(0, 10).map(r => r.motif + 'Ã—' + r.material);
            const chanelSales = brandData.chanel.slice(0, 10).map(r => r.total_sales);

            Plotly.newPlot('chartChanelMotif', [{
                type: 'bar',
                y: chanelMotifs.reverse(),
                x: chanelSales.reverse(),
                orientation: 'h',
                marker: { color: '#E91E63' }
            }], {
                title: { text: 'ã‚·ãƒ£ãƒãƒ« ãƒ¢ãƒãƒ¼ãƒ•Ã—ç´ æ åˆ¥è²©å£²æ•°', font: { color: textColor } },
                paper_bgcolor: bgColor,
                plot_bgcolor: bgColor,
                font: { color: textColor },
                margin: { l: 150, r: 20, t: 40, b: 40 },
                xaxis: { gridcolor: isDark ? '#3a3a5c' : '#e0e0e0' }
            }, { responsive: true });
        }

        initTheme();
        renderAllTables();
        renderCharts();
    </script>
</body>
</html>
