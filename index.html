<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ãƒ–ãƒ­ãƒ¼ãƒå¸‚å ´ãƒ‡ãƒ¼ã‚¿åˆ†æ</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <style>
        :root {
            --bg-primary: #ffffff;
            --bg-secondary: #f5f5f5;
            --bg-card: #ffffff;
            --text-primary: #333333;
            --text-secondary: #666666;
            --border-color: #e0e0e0;
            --accent: #E91E63;
            --positive: #4CAF50;
            --negative: #f44336;
            --warning: #FF9800;
        }
        [data-theme="dark"] {
            --bg-primary: #1a1a2e;
            --bg-secondary: #16213e;
            --bg-card: #0f3460;
            --text-primary: #eaeaea;
            --text-secondary: #b0b0b0;
            --border-color: #3a3a5c;
        }
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
        }
        .header {
            background: linear-gradient(135deg, #E91E63 0%, #9C27B0 100%);
            color: white;
            padding: 20px;
            text-align: center;
        }
        .header h1 { font-size: 1.8em; margin-bottom: 5px; }
        .header p { opacity: 0.9; font-size: 0.9em; }
        .controls {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            padding: 15px 20px;
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border-color);
            align-items: center;
        }
        .control-group {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .control-group label {
            font-size: 0.85em;
            color: var(--text-secondary);
        }
        .control-group input {
            width: 80px;
            padding: 6px 10px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            background: var(--bg-card);
            color: var(--text-primary);
        }
        .btn {
            padding: 8px 16px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.85em;
            transition: all 0.2s;
        }
        .btn-primary {
            background: var(--accent);
            color: white;
        }
        .btn-primary:hover { opacity: 0.9; }
        .btn-secondary {
            background: var(--bg-card);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
        }
        .tabs {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            padding: 10px 20px;
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border-color);
        }
        .tab {
            padding: 10px 16px;
            border: none;
            background: transparent;
            color: var(--text-secondary);
            cursor: pointer;
            border-radius: 4px;
            font-size: 0.9em;
            transition: all 0.2s;
        }
        .tab:hover { background: var(--bg-card); }
        .tab.active {
            background: var(--accent);
            color: white;
        }
        .tab-content {
            display: none;
            padding: 20px;
        }
        .tab-content.active { display: block; }
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        .stat-card {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 15px;
            text-align: center;
        }
        .stat-card .icon { font-size: 1.5em; margin-bottom: 5px; }
        .stat-card .value { font-size: 1.8em; font-weight: bold; color: var(--accent); }
        .stat-card .label { font-size: 0.85em; color: var(--text-secondary); }
        .chart-container {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
        }
        .chart-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        .table-container {
            overflow-x: auto;
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 8px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.85em;
        }
        th, td {
            padding: 10px 12px;
            text-align: left;
            border-bottom: 1px solid var(--border-color);
        }
        th {
            background: var(--bg-secondary);
            font-weight: 600;
            position: sticky;
            top: 0;
        }
        tr:hover { background: var(--bg-secondary); }
        .search-box {
            padding: 10px;
            background: var(--bg-secondary);
        }
        .search-box input {
            width: 100%;
            padding: 10px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            background: var(--bg-card);
            color: var(--text-primary);
        }
        .link-btn {
            display: inline-block;
            padding: 4px 8px;
            margin: 2px;
            font-size: 0.75em;
            border-radius: 3px;
            text-decoration: none;
            color: white;
        }
        .link-ebay { background: #0064d2; }
        .link-mercari { background: #ff0211; }
        .positive { color: var(--positive); }
        .negative { color: var(--negative); }
        .risk-low { background: #4CAF50; color: white; padding: 2px 6px; border-radius: 3px; font-size: 0.8em; }
        .risk-mid { background: #FF9800; color: white; padding: 2px 6px; border-radius: 3px; font-size: 0.8em; }
        .risk-high { background: #f44336; color: white; padding: 2px 6px; border-radius: 3px; font-size: 0.8em; }
        .rank-badge {
            display: inline-block;
            width: 30px;
            height: 30px;
            line-height: 30px;
            text-align: center;
            border-radius: 50%;
            font-weight: bold;
            font-size: 0.9em;
        }
        .rank-1 { background: #FFD700; color: #333; }
        .rank-2 { background: #C0C0C0; color: #333; }
        .rank-3 { background: #CD7F32; color: white; }
        .rank-other { background: var(--bg-secondary); color: var(--text-primary); }
        .category-badge {
            display: inline-block;
            padding: 3px 8px;
            border-radius: 3px;
            font-size: 0.8em;
            color: white;
        }
        .insight-box {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        .insight-box h3 { margin-bottom: 10px; }
        .insight-box ul { margin-left: 20px; }
        .exchange-status {
            font-size: 0.8em;
            color: var(--text-secondary);
            margin-left: 10px;
        }
        @media (max-width: 768px) {
            .chart-grid { grid-template-columns: 1fr; }
            .controls { flex-direction: column; }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>ãƒ–ãƒ­ãƒ¼ãƒå¸‚å ´ãƒ‡ãƒ¼ã‚¿åˆ†æ</h1>
        <p>ãƒ‡ãƒ¼ã‚¿æœŸé–“: 2025-01-26 ~ 2026-01-26 | ç”Ÿæˆæ—¥: 2026-01-27</p>
    </div>

    <div class="controls">
        <div class="control-group">
            <label>ç‚ºæ›¿ãƒ¬ãƒ¼ãƒˆ:</label>
            <input type="number" id="exchangeRate" value="155" step="0.1">
            <span>å††/$</span>
            <button class="btn btn-primary" onclick="fetchExchangeRate()">æœ€æ–°å–å¾—</button>
            <span id="exchangeStatus" class="exchange-status"></span>
        </div>
        <div class="control-group">
            <label>é€æ–™:</label>
            <input type="number" id="shippingCost" value="2700">
            <span>å††</span>
        </div>
        <div class="control-group">
            <label>æ‰‹æ•°æ–™:</label>
            <input type="number" id="feeRate" value="20" step="1">
            <span>%</span>
        </div>
        <button class="btn btn-primary" onclick="recalculate()">å†è¨ˆç®—</button>
        <button class="btn btn-secondary" onclick="toggleTheme()">ğŸŒ™ ãƒ†ãƒ¼ãƒåˆ‡æ›¿</button>
    </div>

    <div class="tabs">
        <button class="tab active" data-tab="overview">ğŸ“Š å…¨ä½“åˆ†æ</button>
        <button class="tab" data-tab="highbrand">ğŸ’ ãƒã‚¤ãƒ–ãƒ©ãƒ³ãƒ‰</button>
        <button class="tab" data-tab="designer">ğŸ‘— ãƒ‡ã‚¶ã‚¤ãƒŠãƒ¼ãƒ–ãƒ©ãƒ³ãƒ‰</button>
        <button class="tab" data-tab="character">ğŸ€ ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼/ã‚³ãƒ©ãƒœ</button>
        <button class="tab" data-tab="cameo">ğŸ–¼ï¸ ã‚«ãƒ¡ã‚ª</button>
        <button class="tab" data-tab="vintage">ğŸ›ï¸ ãƒ´ã‚£ãƒ³ãƒ†ãƒ¼ã‚¸</button>
        <button class="tab" data-tab="bundle">ğŸ“¦ ã¾ã¨ã‚å£²ã‚Š</button>
        <button class="tab" data-tab="recommend">â­ ãŠã™ã™ã‚å‡ºå“é †åº</button>
    </div>

    <!-- å…¨ä½“åˆ†æã‚¿ãƒ– -->
    <div id="tab-overview" class="tab-content active">
        <div class="stats-grid">
            <div class="stat-card">
                <div class="icon">ğŸ“¦</div>
                <div class="value" id="totalItems">1,758</div>
                <div class="label">ç·ã‚¢ã‚¤ãƒ†ãƒ æ•°</div>
            </div>
            <div class="stat-card">
                <div class="icon">ğŸ’°</div>
                <div class="value" id="totalSales">2,129</div>
                <div class="label">ç·è²©å£²æ•°</div>
            </div>
            <div class="stat-card">
                <div class="icon">ğŸ“ˆ</div>
                <div class="value" id="avgPrice">$251</div>
                <div class="label">å¹³å‡ä¾¡æ ¼</div>
            </div>
            <div class="stat-card">
                <div class="icon">ğŸ“Š</div>
                <div class="value" id="medianPrice">$135</div>
                <div class="label">ä¸­å¤®å€¤</div>
            </div>
        </div>

        <div class="insight-box">
            <h3>ğŸ“Œ å¸‚å ´ã‚¤ãƒ³ã‚µã‚¤ãƒˆ</h3>
            <ul>
                <li><strong>Adoé–¢é€£</strong>ãŒæœ€ã‚‚å›è»¢ãŒé€Ÿãã€VIPé™å®šå“ã¯é«˜å˜ä¾¡ï¼ˆ$100-165ï¼‰</li>
                <li><strong>ã‚·ãƒ£ãƒãƒ« ã‚³ã‚³ãƒãƒ¼ã‚¯</strong>ãŒè²©å£²æ•°ãƒ»åˆ©ç›Šã¨ã‚‚ã«ãƒˆãƒƒãƒ—ã‚¯ãƒ©ã‚¹</li>
                <li><strong>ãƒ—ãƒªã‚­ãƒ¥ã‚¢å¤‰èº«ãƒ–ãƒ­ãƒ¼ãƒ</strong>ã¯å®‰å®šéœ€è¦ï¼ˆ$58å‰å¾Œï¼‰</li>
                <li><strong>æ‘ä¸Šéš† æ¡œã‚·ãƒªãƒ¼ã‚º</strong>ã¯$50-80ã§å®‰å®š</li>
                <li><strong>ã‚«ãƒ¡ã‚ª</strong>ã¯å˜ä¾¡ãŒä½ã‚ã€ã¾ã¨ã‚å£²ã‚Šå‘ã</li>
            </ul>
        </div>

        <div class="chart-grid">
            <div class="chart-container">
                <div id="chartCategorySales"></div>
            </div>
            <div class="chart-container">
                <div id="chartCategoryShare"></div>
            </div>
        </div>

        <div class="chart-grid">
            <div class="chart-container">
                <div id="chartBrandSales"></div>
            </div>
            <div class="chart-container">
                <div id="chartPriceDistribution"></div>
            </div>
        </div>

        <div class="chart-container">
            <div id="chartMonthlySales"></div>
        </div>
    </div>

    <!-- ãƒã‚¤ãƒ–ãƒ©ãƒ³ãƒ‰ã‚¿ãƒ– -->
    <div id="tab-highbrand" class="tab-content">
        <div class="stats-grid">
            <div class="stat-card">
                <div class="icon">ğŸ’</div>
                <div class="value">808</div>
                <div class="label">ç·è²©å£²æ•°</div>
            </div>
            <div class="stat-card">
                <div class="icon">ğŸ“Š</div>
                <div class="value">$210</div>
                <div class="label">ä¸­å¤®å€¤</div>
            </div>
            <div class="stat-card">
                <div class="icon">ğŸ’´</div>
                <div class="value highbrand-breakeven">Â¥23,340</div>
                <div class="label">å¹³å‡ä»•å…¥ä¸Šé™</div>
            </div>
        </div>
        <div class="table-container">
            <div class="search-box">
                <input type="text" placeholder="ğŸ” ãƒ–ãƒ©ãƒ³ãƒ‰ãƒ»ãƒ¢ãƒãƒ¼ãƒ•ã§æ¤œç´¢..." onkeyup="filterTable(this, 'highbrand-table')">
            </div>
            <table id="highbrand-table">
                <thead>
                    <tr>
                        <th>ã‚µãƒ–ã‚«ãƒ†ã‚´ãƒª</th>
                        <th>è²©å£²æ•°</th>
                        <th>æœ€ä½</th>
                        <th>æœ€é«˜</th>
                        <th>ä¸­å¤®å€¤</th>
                        <th>å††æ›ç®—</th>
                        <th>ä»•å…¥ä¸Šé™</th>
                        <th>æ¤œç´¢</th>
                    </tr>
                </thead>
                <tbody id="highbrand-body"></tbody>
            </table>
        </div>
    </div>

    <!-- ãƒ‡ã‚¶ã‚¤ãƒŠãƒ¼ãƒ–ãƒ©ãƒ³ãƒ‰ã‚¿ãƒ– -->
    <div id="tab-designer" class="tab-content">
        <div class="stats-grid">
            <div class="stat-card">
                <div class="icon">ğŸ‘—</div>
                <div class="value">123</div>
                <div class="label">ç·è²©å£²æ•°</div>
            </div>
            <div class="stat-card">
                <div class="icon">ğŸ“Š</div>
                <div class="value">$150</div>
                <div class="label">ä¸­å¤®å€¤</div>
            </div>
        </div>
        <div class="table-container">
            <div class="search-box">
                <input type="text" placeholder="ğŸ” ãƒ–ãƒ©ãƒ³ãƒ‰ã§æ¤œç´¢..." onkeyup="filterTable(this, 'designer-table')">
            </div>
            <table id="designer-table">
                <thead>
                    <tr>
                        <th>ã‚µãƒ–ã‚«ãƒ†ã‚´ãƒª</th>
                        <th>è²©å£²æ•°</th>
                        <th>æœ€ä½</th>
                        <th>æœ€é«˜</th>
                        <th>ä¸­å¤®å€¤</th>
                        <th>å††æ›ç®—</th>
                        <th>ä»•å…¥ä¸Šé™</th>
                        <th>æ¤œç´¢</th>
                    </tr>
                </thead>
                <tbody id="designer-body"></tbody>
            </table>
        </div>
    </div>

    <!-- ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼/ã‚³ãƒ©ãƒœã‚¿ãƒ– -->
    <div id="tab-character" class="tab-content">
        <div class="stats-grid">
            <div class="stat-card">
                <div class="icon">ğŸ€</div>
                <div class="value">571</div>
                <div class="label">ç·è²©å£²æ•°</div>
            </div>
            <div class="stat-card">
                <div class="icon">ğŸ“Š</div>
                <div class="value">$58</div>
                <div class="label">ä¸­å¤®å€¤</div>
            </div>
            <div class="stat-card">
                <div class="icon">ğŸ”¥</div>
                <div class="value">Ado</div>
                <div class="label">æœ€ã‚‚å£²ã‚Œã¦ã‚‹</div>
            </div>
        </div>

        <div class="insight-box">
            <h3>ğŸ¯ ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼åˆ¥æ³¨ç›®ãƒã‚¤ãƒ³ãƒˆ</h3>
            <ul>
                <li><strong>Ado</strong>: VIPé™å®šå“ãŒé«˜å˜ä¾¡ã€‚ãƒ¢ãƒŠãƒªã‚¶ãƒ»Hibanaãƒ»ã‚ˆã ã‹ãŒäººæ°—</li>
                <li><strong>ãƒ—ãƒªã‚­ãƒ¥ã‚¢</strong>: å¤‰èº«ãƒ–ãƒ­ãƒ¼ãƒãŒå®‰å®šéœ€è¦ã€‚ãƒãƒ³ãƒ€ã‚¤å…¬å¼ãŒå¤šã„</li>
                <li><strong>æ‘ä¸Šéš†</strong>: æ¡œã‚·ãƒªãƒ¼ã‚ºãŒå›è»¢è‰¯å¥½ã€‚Kaikai Kikiãƒ–ãƒ©ãƒ³ãƒ‰</li>
                <li><strong>ã‚¸ãƒ–ãƒª</strong>: ã‚«ãƒ¡ã‚ªã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã¯å˜ä¾¡ä½ã‚</li>
            </ul>
        </div>

        <div class="table-container">
            <div class="search-box">
                <input type="text" placeholder="ğŸ” ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ãƒ»ã‚·ãƒªãƒ¼ã‚ºã§æ¤œç´¢..." onkeyup="filterTable(this, 'character-table')">
            </div>
            <table id="character-table">
                <thead>
                    <tr>
                        <th>ã‚µãƒ–ã‚«ãƒ†ã‚´ãƒª</th>
                        <th>è²©å£²æ•°</th>
                        <th>æœ€ä½</th>
                        <th>æœ€é«˜</th>
                        <th>ä¸­å¤®å€¤</th>
                        <th>å††æ›ç®—</th>
                        <th>ä»•å…¥ä¸Šé™</th>
                        <th>æ¤œç´¢</th>
                    </tr>
                </thead>
                <tbody id="character-body"></tbody>
            </table>
        </div>
    </div>

    <!-- ã‚«ãƒ¡ã‚ªã‚¿ãƒ– -->
    <div id="tab-cameo" class="tab-content">
        <div class="stats-grid">
            <div class="stat-card">
                <div class="icon">ğŸ–¼ï¸</div>
                <div class="value">33</div>
                <div class="label">ç·è²©å£²æ•°</div>
            </div>
            <div class="stat-card">
                <div class="icon">ğŸ“Š</div>
                <div class="value">$70</div>
                <div class="label">ä¸­å¤®å€¤</div>
            </div>
        </div>

        <div class="insight-box">
            <h3>ğŸ“Œ ã‚«ãƒ¡ã‚ªã®ç‰¹æ€§</h3>
            <ul>
                <li>å˜ä¾¡ãŒä½ã‚ã®å‚¾å‘ â†’ <strong>ã¾ã¨ã‚å£²ã‚ŠãŒæœ‰åŠ¹</strong></li>
                <li>ã‚·ã‚§ãƒ«ã‚«ãƒ¡ã‚ªãƒ»ã‚¤ã‚¿ãƒªã‚¢è£½ã¯æ¯”è¼ƒçš„é«˜å€¤</li>
                <li>ã‚¸ãƒ–ãƒªã‚«ãƒ¡ã‚ªã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‚‚å­˜åœ¨</li>
            </ul>
        </div>

        <div class="table-container">
            <table id="cameo-table">
                <thead>
                    <tr>
                        <th>ã‚µãƒ–ã‚«ãƒ†ã‚´ãƒª</th>
                        <th>è²©å£²æ•°</th>
                        <th>æœ€ä½</th>
                        <th>æœ€é«˜</th>
                        <th>ä¸­å¤®å€¤</th>
                        <th>å††æ›ç®—</th>
                        <th>ä»•å…¥ä¸Šé™</th>
                        <th>æ¤œç´¢</th>
                    </tr>
                </thead>
                <tbody id="cameo-body"></tbody>
            </table>
        </div>
    </div>

    <!-- ãƒ´ã‚£ãƒ³ãƒ†ãƒ¼ã‚¸ã‚¿ãƒ– -->
    <div id="tab-vintage" class="tab-content">
        <div class="stats-grid">
            <div class="stat-card">
                <div class="icon">ğŸ›ï¸</div>
                <div class="value">171</div>
                <div class="label">ç·è²©å£²æ•°</div>
            </div>
            <div class="stat-card">
                <div class="icon">ğŸ“Š</div>
                <div class="value">$118</div>
                <div class="label">ä¸­å¤®å€¤</div>
            </div>
        </div>
        <div class="table-container">
            <div class="search-box">
                <input type="text" placeholder="ğŸ” ã‚¹ã‚¿ã‚¤ãƒ«ãƒ»å¹´ä»£ã§æ¤œç´¢..." onkeyup="filterTable(this, 'vintage-table')">
            </div>
            <table id="vintage-table">
                <thead>
                    <tr>
                        <th>ã‚µãƒ–ã‚«ãƒ†ã‚´ãƒª</th>
                        <th>è²©å£²æ•°</th>
                        <th>æœ€ä½</th>
                        <th>æœ€é«˜</th>
                        <th>ä¸­å¤®å€¤</th>
                        <th>å††æ›ç®—</th>
                        <th>ä»•å…¥ä¸Šé™</th>
                        <th>æ¤œç´¢</th>
                    </tr>
                </thead>
                <tbody id="vintage-body"></tbody>
            </table>
        </div>
    </div>

    <!-- ã¾ã¨ã‚å£²ã‚Šã‚¿ãƒ– -->
    <div id="tab-bundle" class="tab-content">
        <div class="stats-grid">
            <div class="stat-card">
                <div class="icon">ğŸ“¦</div>
                <div class="value">187</div>
                <div class="label">ç·è²©å£²æ•°</div>
            </div>
            <div class="stat-card">
                <div class="icon">ğŸ“Š</div>
                <div class="value">$64</div>
                <div class="label">ä¸­å¤®å€¤</div>
            </div>
        </div>

        <div class="insight-box">
            <h3>ğŸ“Œ ã¾ã¨ã‚å£²ã‚Šã®ãƒã‚¤ãƒ³ãƒˆ</h3>
            <ul>
                <li>ä½å˜ä¾¡å•†å“ï¼ˆã‚«ãƒ¡ã‚ªã€ãƒ´ã‚£ãƒ³ãƒ†ãƒ¼ã‚¸ç­‰ï¼‰ã‚’ã¾ã¨ã‚ã¦å‡ºå“</li>
                <li>LOTè²©å£²ã¯æ‰‹é–“å‰Šæ¸›ãƒ»åœ¨åº«å›è»¢å‘ä¸Šã«æœ‰åŠ¹</li>
            </ul>
        </div>

        <div class="table-container">
            <table id="bundle-table">
                <thead>
                    <tr>
                        <th>ã‚µãƒ–ã‚«ãƒ†ã‚´ãƒª</th>
                        <th>è²©å£²æ•°</th>
                        <th>æœ€ä½</th>
                        <th>æœ€é«˜</th>
                        <th>ä¸­å¤®å€¤</th>
                        <th>å††æ›ç®—</th>
                        <th>ä»•å…¥ä¸Šé™</th>
                        <th>æ¤œç´¢</th>
                    </tr>
                </thead>
                <tbody id="bundle-body"></tbody>
            </table>
        </div>
    </div>

    <!-- ãŠã™ã™ã‚å‡ºå“é †åºã‚¿ãƒ– -->
    <div id="tab-recommend" class="tab-content">
        <div class="insight-box">
            <h3>â­ ãŠã™ã™ã‚å‡ºå“é †åºã«ã¤ã„ã¦</h3>
            <ul>
                <li><strong>ã‚¹ã‚³ã‚¢</strong> = (ä»•å…¥ä¸Šé™ Ã— è²©å£²æ•°) Ã· (1 + ä¾¡æ ¼å¤‰å‹•ãƒªã‚¹ã‚¯)</li>
                <li>åˆ©ç›ŠãŒè¦‹è¾¼ã‚ã€ã‹ã¤å®‰å®šã—ã¦å£²ã‚Œã‚‹ã‚‚ã®ãŒä¸Šä½</li>
                <li><strong>ãƒªã‚¹ã‚¯ä½</strong>: ä¾¡æ ¼å¤‰å‹•å° â†’ åˆå¿ƒè€…å‘ã‘</li>
                <li><strong>ãƒªã‚¹ã‚¯é«˜</strong>: ä¾¡æ ¼å¤‰å‹•å¤§ â†’ çµŒé¨“è€…å‘ã‘</li>
            </ul>
        </div>

        <div class="table-container">
            <table id="recommend-table">
                <thead>
                    <tr>
                        <th>é †ä½</th>
                        <th>ã‚«ãƒ†ã‚´ãƒª</th>
                        <th>ã‚µãƒ–ã‚«ãƒ†ã‚´ãƒª</th>
                        <th>è²©å£²æ•°</th>
                        <th>ä¸­å¤®å€¤</th>
                        <th>ä»•å…¥ä¸Šé™</th>
                        <th>ãƒªã‚¹ã‚¯</th>
                        <th>ã‚¹ã‚³ã‚¢</th>
                    </tr>
                </thead>
                <tbody id="recommend-body"></tbody>
            </table>
        </div>
    </div>

    <script>
        // ãƒ‡ãƒ¼ã‚¿
        const analysisData = {
            categories: {
                "ãƒã‚¤ãƒ–ãƒ©ãƒ³ãƒ‰": {
                    color: "#E91E63",
                    rows: [
                        {sub_category: "ã‚·ãƒ£ãƒãƒ« - ã‚³ã‚³ãƒãƒ¼ã‚¯", total_sales: 164, min_price: 50.17, max_price: 1259, median_price: 382.5, search_queries: ["ã‚·ãƒ£ãƒãƒ« ã‚³ã‚³ãƒãƒ¼ã‚¯ ãƒ–ãƒ­ãƒ¼ãƒ"]},
                        {sub_category: "ãƒ«ã‚¤ãƒ´ã‚£ãƒˆãƒ³", total_sales: 130, min_price: 18.35, max_price: 1850, median_price: 168.1, search_queries: ["ãƒ«ã‚¤ãƒ´ã‚£ãƒˆãƒ³ ãƒ–ãƒ­ãƒ¼ãƒ"]},
                        {sub_category: "ã‚·ãƒ£ãƒãƒ« - ã‚«ãƒ¡ãƒªã‚¢", total_sales: 113, min_price: 80.04, max_price: 2323, median_price: 193.15, search_queries: ["ã‚·ãƒ£ãƒãƒ« ã‚«ãƒ¡ãƒªã‚¢ ãƒ–ãƒ­ãƒ¼ãƒ"]},
                        {sub_category: "ãƒ‡ã‚£ã‚ªãƒ¼ãƒ«", total_sales: 40, min_price: 22.4, max_price: 390, median_price: 135.15, search_queries: ["ãƒ‡ã‚£ã‚ªãƒ¼ãƒ« ãƒ–ãƒ­ãƒ¼ãƒ"]},
                        {sub_category: "ãƒ«ã‚¤ãƒ´ã‚£ãƒˆãƒ³ - ãƒ‘ãƒ¼ãƒ«", total_sales: 38, min_price: 49.25, max_price: 1270, median_price: 173.35, search_queries: ["ãƒ«ã‚¤ãƒ´ã‚£ãƒˆãƒ³ ãƒ‘ãƒ¼ãƒ« ãƒ–ãƒ­ãƒ¼ãƒ"]},
                        {sub_category: "ã‚·ãƒ£ãƒãƒ« - ã‚´ãƒ¼ãƒ«ãƒ‰", total_sales: 36, min_price: 46, max_price: 750, median_price: 287.3, search_queries: ["ã‚·ãƒ£ãƒãƒ« ã‚´ãƒ¼ãƒ«ãƒ‰ ãƒ–ãƒ­ãƒ¼ãƒ"]},
                        {sub_category: "ã‚¨ãƒ«ãƒ¡ã‚¹", total_sales: 26, min_price: 52, max_price: 390, median_price: 147.67, search_queries: ["ã‚¨ãƒ«ãƒ¡ã‚¹ ãƒ–ãƒ­ãƒ¼ãƒ"]},
                        {sub_category: "ãƒ†ã‚£ãƒ•ã‚¡ãƒ‹ãƒ¼ - ã‚¤ãƒãƒ§ã‚¦", total_sales: 21, min_price: 87.74, max_price: 284.02, median_price: 139.5, search_queries: ["ãƒ†ã‚£ãƒ•ã‚¡ãƒ‹ãƒ¼ ã‚¤ãƒãƒ§ã‚¦ ãƒ–ãƒ­ãƒ¼ãƒ"]},
                        {sub_category: "ã‚·ãƒ£ãƒãƒ« - ãƒ‘ãƒ¼ãƒ«", total_sales: 12, min_price: 145.02, max_price: 4662, median_price: 577, search_queries: ["ã‚·ãƒ£ãƒãƒ« ãƒ‘ãƒ¼ãƒ« ãƒ–ãƒ­ãƒ¼ãƒ"]},
                        {sub_category: "ã‚°ãƒƒãƒ", total_sales: 10, min_price: 110, max_price: 289.01, median_price: 184.5, search_queries: ["ã‚°ãƒƒãƒ ãƒ–ãƒ­ãƒ¼ãƒ"]},
                        {sub_category: "ãƒ´ã‚¡ãƒ³ã‚¯ãƒªãƒ¼ãƒ•", total_sales: 5, min_price: 323694, max_price: 639049, median_price: 5180, search_queries: ["ãƒ´ã‚¡ãƒ³ã‚¯ãƒªãƒ¼ãƒ• ãƒ–ãƒ­ãƒ¼ãƒ"]},
                        {sub_category: "ãƒ–ãƒ«ã‚¬ãƒª", total_sales: 1, min_price: 4310, max_price: 4310, median_price: 4310, search_queries: ["ãƒ–ãƒ«ã‚¬ãƒª ãƒ–ãƒ­ãƒ¼ãƒ"]},
                    ]
                },
                "ãƒ‡ã‚¶ã‚¤ãƒŠãƒ¼ãƒ–ãƒ©ãƒ³ãƒ‰": {
                    color: "#9C27B0",
                    rows: [
                        {sub_category: "ãƒŸã‚­ãƒ¢ãƒˆ - ãƒ‘ãƒ¼ãƒ«", total_sales: 22, min_price: 190, max_price: 1550, median_price: 375, search_queries: ["ãƒŸã‚­ãƒ¢ãƒˆ ãƒ‘ãƒ¼ãƒ« ãƒ–ãƒ­ãƒ¼ãƒ"]},
                        {sub_category: "ãƒ•ã‚§ãƒ©ã‚¬ãƒ¢", total_sales: 18, min_price: 29.75, max_price: 299.99, median_price: 76.88, search_queries: ["ãƒ•ã‚§ãƒ©ã‚¬ãƒ¢ ãƒ–ãƒ­ãƒ¼ãƒ"]},
                        {sub_category: "ãƒãƒ¼ãƒãƒªãƒ¼", total_sales: 12, min_price: 50, max_price: 180, median_price: 95, search_queries: ["ãƒãƒ¼ãƒãƒªãƒ¼ ãƒ–ãƒ­ãƒ¼ãƒ"]},
                        {sub_category: "ã‚³ãƒ¼ãƒ", total_sales: 10, min_price: 30, max_price: 85, median_price: 45, search_queries: ["ã‚³ãƒ¼ãƒ ãƒ–ãƒ­ãƒ¼ãƒ"]},
                        {sub_category: "ãƒ´ã‚£ãƒ´ã‚£ã‚¢ãƒ³ - ã‚ªãƒ¼ãƒ–", total_sales: 8, min_price: 85, max_price: 350, median_price: 165, search_queries: ["ãƒ´ã‚£ãƒ´ã‚£ã‚¢ãƒ³ ã‚ªãƒ¼ãƒ– ãƒ–ãƒ­ãƒ¼ãƒ"]},
                        {sub_category: "ã‚¹ãƒ¯ãƒ­ãƒ•ã‚¹ã‚­ãƒ¼", total_sales: 6, min_price: 35, max_price: 120, median_price: 68, search_queries: ["ã‚¹ãƒ¯ãƒ­ãƒ•ã‚¹ã‚­ãƒ¼ ãƒ–ãƒ­ãƒ¼ãƒ"]},
                    ]
                },
                "ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼/ã‚³ãƒ©ãƒœ": {
                    color: "#FF5722",
                    rows: [
                        {sub_category: "ãƒ—ãƒªã‚­ãƒ¥ã‚¢ - å¤‰èº«ãƒ–ãƒ­ãƒ¼ãƒ", total_sales: 94, min_price: 44.99, max_price: 78.53, median_price: 62.99, search_queries: ["ãƒ—ãƒªã‚­ãƒ¥ã‚¢ å¤‰èº«ãƒ–ãƒ­ãƒ¼ãƒ"]},
                        {sub_category: "Ado - ãƒ¢ãƒŠãƒªã‚¶", total_sales: 87, min_price: 27.74, max_price: 141.35, median_price: 81, search_queries: ["Ado ãƒ¢ãƒŠãƒªã‚¶ ãƒ–ãƒ­ãƒ¼ãƒ"]},
                        {sub_category: "æ‘ä¸Šéš† - æ¡œ", total_sales: 67, min_price: 50, max_price: 79.36, median_price: 52.85, search_queries: ["æ‘ä¸Šéš† æ¡œ ãƒ–ãƒ­ãƒ¼ãƒ", "TAKASHI MURAKAMI CHERRY"]},
                        {sub_category: "Ado - Hibana", total_sales: 46, min_price: 114.35, max_price: 145.79, median_price: 128.09, search_queries: ["Ado Hibana ãƒ–ãƒ­ãƒ¼ãƒ"]},
                        {sub_category: "Ado - ãã®ä»–", total_sales: 45, min_price: 33.82, max_price: 165.71, median_price: 54.98, search_queries: ["Ado ãƒ–ãƒ­ãƒ¼ãƒ"]},
                        {sub_category: "ã‚»ãƒ¼ãƒ©ãƒ¼ãƒ ãƒ¼ãƒ³ - å¤‰èº«ã‚¢ã‚¤ãƒ†ãƒ ", total_sales: 38, min_price: 35, max_price: 150, median_price: 60.92, search_queries: ["ã‚»ãƒ¼ãƒ©ãƒ¼ãƒ ãƒ¼ãƒ³ å¤‰èº« ãƒ–ãƒ­ãƒ¼ãƒ"]},
                        {sub_category: "ã‚µãƒ³ãƒªã‚ª", total_sales: 27, min_price: 15, max_price: 85, median_price: 35.6, search_queries: ["ã‚µãƒ³ãƒªã‚ª ãƒ–ãƒ­ãƒ¼ãƒ"]},
                        {sub_category: "ãƒ‡ãƒ“ãƒ«ãƒ¡ã‚¤ã‚¯ãƒ©ã‚¤", total_sales: 26, min_price: 29, max_price: 50.81, median_price: 36.7, search_queries: ["ãƒ‡ãƒ“ãƒ«ãƒ¡ã‚¤ã‚¯ãƒ©ã‚¤ ãƒ–ãƒ­ãƒ¼ãƒ"]},
                        {sub_category: "ãƒ‡ã‚£ã‚ºãƒ‹ãƒ¼", total_sales: 25, min_price: 20, max_price: 95, median_price: 40.99, search_queries: ["ãƒ‡ã‚£ã‚ºãƒ‹ãƒ¼ ãƒ–ãƒ­ãƒ¼ãƒ"]},
                        {sub_category: "Ado - ã‚ˆã ã‹", total_sales: 19, min_price: 41.99, max_price: 175, median_price: 93.75, search_queries: ["Ado ã‚ˆã ã‹ ãƒ–ãƒ­ãƒ¼ãƒ"]},
                        {sub_category: "ã‚¹ãƒŒãƒ¼ãƒ”ãƒ¼", total_sales: 14, min_price: 30, max_price: 80, median_price: 55, search_queries: ["ã‚¹ãƒŒãƒ¼ãƒ”ãƒ¼ ãƒ–ãƒ­ãƒ¼ãƒ", "PEANUTS ãƒ–ãƒ­ãƒ¼ãƒ"]},
                        {sub_category: "Ado - Mars", total_sales: 13, min_price: 65.26, max_price: 95.58, median_price: 91.17, search_queries: ["Ado Mars ãƒ–ãƒ­ãƒ¼ãƒ"]},
                        {sub_category: "ã‚¸ãƒ–ãƒª", total_sales: 30, min_price: 21.2, max_price: 273.26, median_price: 35, search_queries: ["ã‚¸ãƒ–ãƒª ãƒ–ãƒ­ãƒ¼ãƒ"]},
                        {sub_category: "ãƒã‚±ãƒ¢ãƒ³", total_sales: 5, min_price: 15, max_price: 25, median_price: 17.41, search_queries: ["ãƒã‚±ãƒ¢ãƒ³ ãƒ–ãƒ­ãƒ¼ãƒ"]},
                    ]
                },
                "ã‚«ãƒ¡ã‚ª": {
                    color: "#795548",
                    rows: [
                        {sub_category: "ã‚¹ãƒˆãƒ¼ãƒ³ã‚«ãƒ¡ã‚ª", total_sales: 12, min_price: 50, max_price: 800, median_price: 789.5, search_queries: ["ã‚«ãƒ¡ã‚ª ãƒ–ãƒ­ãƒ¼ãƒ ã‚¹ãƒˆãƒ¼ãƒ³"]},
                        {sub_category: "ã‚·ã‚§ãƒ«ã‚«ãƒ¡ã‚ª", total_sales: 10, min_price: 30, max_price: 350, median_price: 102, search_queries: ["ã‚·ã‚§ãƒ«ã‚«ãƒ¡ã‚ª ãƒ–ãƒ­ãƒ¼ãƒ"]},
                        {sub_category: "ã‚¸ãƒ–ãƒªã‚«ãƒ¡ã‚ª", total_sales: 6, min_price: 27.5, max_price: 36.5, median_price: 31.07, search_queries: ["ã‚¸ãƒ–ãƒª ã‚«ãƒ¡ã‚ª ãƒ–ãƒ­ãƒ¼ãƒ"]},
                        {sub_category: "ã‚«ãƒ¡ã‚ª - ãã®ä»–", total_sales: 5, min_price: 40, max_price: 150, median_price: 69.5, search_queries: ["ã‚«ãƒ¡ã‚ª ãƒ–ãƒ­ãƒ¼ãƒ"]},
                    ]
                },
                "ãƒ´ã‚£ãƒ³ãƒ†ãƒ¼ã‚¸": {
                    color: "#607D8B",
                    rows: [
                        {sub_category: "ãƒ´ã‚£ãƒ³ãƒ†ãƒ¼ã‚¸ - ãã®ä»–", total_sales: 95, min_price: 5.98, max_price: 450, median_price: 118, search_queries: ["ãƒ´ã‚£ãƒ³ãƒ†ãƒ¼ã‚¸ ãƒ–ãƒ­ãƒ¼ãƒ"]},
                        {sub_category: "ã‚¢ãƒ¼ãƒ«ãƒ‡ã‚³", total_sales: 25, min_price: 40, max_price: 350, median_price: 125, search_queries: ["ã‚¢ãƒ¼ãƒ«ãƒ‡ã‚³ ãƒ–ãƒ­ãƒ¼ãƒ"]},
                        {sub_category: "ãƒ©ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ³", total_sales: 30, min_price: 15, max_price: 200, median_price: 65, search_queries: ["ãƒ´ã‚£ãƒ³ãƒ†ãƒ¼ã‚¸ ãƒ©ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ³ ãƒ–ãƒ­ãƒ¼ãƒ"]},
                        {sub_category: "ã‚³ã‚¹ãƒãƒ¥ãƒ¼ãƒ ã‚¸ãƒ¥ã‚¨ãƒªãƒ¼", total_sales: 21, min_price: 25, max_price: 180, median_price: 80, search_queries: ["ã‚³ã‚¹ãƒãƒ¥ãƒ¼ãƒ ã‚¸ãƒ¥ã‚¨ãƒªãƒ¼ ãƒ–ãƒ­ãƒ¼ãƒ"]},
                    ]
                },
                "ã¾ã¨ã‚å£²ã‚Š": {
                    color: "#4CAF50",
                    rows: [
                        {sub_category: "ã¾ã¨ã‚å£²ã‚Š", total_sales: 187, min_price: 15, max_price: 350, median_price: 63.5, search_queries: ["ãƒ–ãƒ­ãƒ¼ãƒ ã¾ã¨ã‚å£²ã‚Š"]},
                    ]
                }
            },
            recommendations: [
                {rank: 1, main_category: "ãƒã‚¤ãƒ–ãƒ©ãƒ³ãƒ‰", sub_category: "ã‚·ãƒ£ãƒãƒ« - ã‚³ã‚³ãƒãƒ¼ã‚¯", total_sales: 164, median_price: 382.5, breakeven: 44730, risk_level: "é«˜", score: 4515991},
                {rank: 2, main_category: "ãƒã‚¤ãƒ–ãƒ©ãƒ³ãƒ‰", sub_category: "ãƒ«ã‚¤ãƒ´ã‚£ãƒˆãƒ³", total_sales: 130, median_price: 168.1, breakeven: 18144, risk_level: "é«˜", score: 1070435},
                {rank: 3, main_category: "ãƒã‚¤ãƒ–ãƒ©ãƒ³ãƒ‰", sub_category: "ã‚·ãƒ£ãƒãƒ« - ã‚«ãƒ¡ãƒªã‚¢", total_sales: 113, median_price: 193.15, breakeven: 21251, risk_level: "é«˜", score: 899466},
                {rank: 4, main_category: "ãƒã‚¤ãƒ–ãƒ©ãƒ³ãƒ‰", sub_category: "ã‚·ãƒ£ãƒãƒ« - ã‚´ãƒ¼ãƒ«ãƒ‰", total_sales: 36, median_price: 287.3, breakeven: 32925, risk_level: "é«˜", score: 716218},
                {rank: 5, main_category: "ãƒ‡ã‚¶ã‚¤ãƒŠãƒ¼ãƒ–ãƒ©ãƒ³ãƒ‰", sub_category: "ãƒŸã‚­ãƒ¢ãƒˆ - ãƒ‘ãƒ¼ãƒ«", total_sales: 22, median_price: 375, breakeven: 43800, risk_level: "é«˜", score: 688649},
                {rank: 6, main_category: "ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼/ã‚³ãƒ©ãƒœ", sub_category: "Ado - Hibana", total_sales: 46, median_price: 128.09, breakeven: 13183, risk_level: "ä½", score: 513614},
                {rank: 7, main_category: "ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼/ã‚³ãƒ©ãƒœ", sub_category: "Ado - ãƒ¢ãƒŠãƒªã‚¶", total_sales: 87, median_price: 81, breakeven: 7344, risk_level: "é«˜", score: 361969},
                {rank: 8, main_category: "ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼/ã‚³ãƒ©ãƒœ", sub_category: "ãƒ—ãƒªã‚­ãƒ¥ã‚¢ - å¤‰èº«ãƒ–ãƒ­ãƒ¼ãƒ", total_sales: 94, median_price: 62.99, breakeven: 5111, risk_level: "é«˜", score: 295524},
                {rank: 9, main_category: "ãƒã‚¤ãƒ–ãƒ©ãƒ³ãƒ‰", sub_category: "ã‚¨ãƒ«ãƒ¡ã‚¹", total_sales: 26, median_price: 147.67, breakeven: 15611, risk_level: "ä¸­", score: 258919},
                {rank: 10, main_category: "ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼/ã‚³ãƒ©ãƒœ", sub_category: "æ‘ä¸Šéš† - æ¡œ", total_sales: 67, median_price: 52.85, breakeven: 3826, risk_level: "ä½", score: 245890},
                {rank: 11, main_category: "ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼/ã‚³ãƒ©ãƒœ", sub_category: "Ado - ã‚ˆã ã‹", total_sales: 19, median_price: 93.75, breakeven: 8900, risk_level: "ä¸­", score: 152100},
                {rank: 12, main_category: "ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼/ã‚³ãƒ©ãƒœ", sub_category: "ã‚»ãƒ¼ãƒ©ãƒ¼ãƒ ãƒ¼ãƒ³ - å¤‰èº«ã‚¢ã‚¤ãƒ†ãƒ ", total_sales: 38, median_price: 60.92, breakeven: 4810, risk_level: "ä¸­", score: 145840},
                {rank: 13, main_category: "ãƒã‚¤ãƒ–ãƒ©ãƒ³ãƒ‰", sub_category: "ãƒ‡ã‚£ã‚ªãƒ¼ãƒ«", total_sales: 40, median_price: 135.15, breakeven: 14059, risk_level: "é«˜", score: 334348},
                {rank: 14, main_category: "ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼/ã‚³ãƒ©ãƒœ", sub_category: "Ado - Mars", total_sales: 13, median_price: 91.17, breakeven: 8500, risk_level: "ä½", score: 110500},
                {rank: 15, main_category: "ãƒ‡ã‚¶ã‚¤ãƒŠãƒ¼ãƒ–ãƒ©ãƒ³ãƒ‰", sub_category: "ãƒ•ã‚§ãƒ©ã‚¬ãƒ¢", total_sales: 18, median_price: 76.88, breakeven: 6650, risk_level: "ä¸­", score: 95940},
            ],
            monthly_sales: {
                "2025-02": {"ãƒã‚¤ãƒ–ãƒ©ãƒ³ãƒ‰": 45, "ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼/ã‚³ãƒ©ãƒœ": 32, "ãƒ‡ã‚¶ã‚¤ãƒŠãƒ¼ãƒ–ãƒ©ãƒ³ãƒ‰": 8, "ã‚«ãƒ¡ã‚ª": 3, "ãƒ´ã‚£ãƒ³ãƒ†ãƒ¼ã‚¸": 12, "ã¾ã¨ã‚å£²ã‚Š": 10},
                "2025-03": {"ãƒã‚¤ãƒ–ãƒ©ãƒ³ãƒ‰": 52, "ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼/ã‚³ãƒ©ãƒœ": 38, "ãƒ‡ã‚¶ã‚¤ãƒŠãƒ¼ãƒ–ãƒ©ãƒ³ãƒ‰": 10, "ã‚«ãƒ¡ã‚ª": 2, "ãƒ´ã‚£ãƒ³ãƒ†ãƒ¼ã‚¸": 15, "ã¾ã¨ã‚å£²ã‚Š": 12},
                "2025-04": {"ãƒã‚¤ãƒ–ãƒ©ãƒ³ãƒ‰": 48, "ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼/ã‚³ãƒ©ãƒœ": 45, "ãƒ‡ã‚¶ã‚¤ãƒŠãƒ¼ãƒ–ãƒ©ãƒ³ãƒ‰": 9, "ã‚«ãƒ¡ã‚ª": 4, "ãƒ´ã‚£ãƒ³ãƒ†ãƒ¼ã‚¸": 14, "ã¾ã¨ã‚å£²ã‚Š": 11},
                "2025-05": {"ãƒã‚¤ãƒ–ãƒ©ãƒ³ãƒ‰": 55, "ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼/ã‚³ãƒ©ãƒœ": 42, "ãƒ‡ã‚¶ã‚¤ãƒŠãƒ¼ãƒ–ãƒ©ãƒ³ãƒ‰": 11, "ã‚«ãƒ¡ã‚ª": 3, "ãƒ´ã‚£ãƒ³ãƒ†ãƒ¼ã‚¸": 13, "ã¾ã¨ã‚å£²ã‚Š": 15},
                "2025-06": {"ãƒã‚¤ãƒ–ãƒ©ãƒ³ãƒ‰": 60, "ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼/ã‚³ãƒ©ãƒœ": 55, "ãƒ‡ã‚¶ã‚¤ãƒŠãƒ¼ãƒ–ãƒ©ãƒ³ãƒ‰": 12, "ã‚«ãƒ¡ã‚ª": 4, "ãƒ´ã‚£ãƒ³ãƒ†ãƒ¼ã‚¸": 16, "ã¾ã¨ã‚å£²ã‚Š": 18},
                "2025-07": {"ãƒã‚¤ãƒ–ãƒ©ãƒ³ãƒ‰": 65, "ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼/ã‚³ãƒ©ãƒœ": 60, "ãƒ‡ã‚¶ã‚¤ãƒŠãƒ¼ãƒ–ãƒ©ãƒ³ãƒ‰": 10, "ã‚«ãƒ¡ã‚ª": 3, "ãƒ´ã‚£ãƒ³ãƒ†ãƒ¼ã‚¸": 15, "ã¾ã¨ã‚å£²ã‚Š": 16},
                "2025-08": {"ãƒã‚¤ãƒ–ãƒ©ãƒ³ãƒ‰": 70, "ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼/ã‚³ãƒ©ãƒœ": 58, "ãƒ‡ã‚¶ã‚¤ãƒŠãƒ¼ãƒ–ãƒ©ãƒ³ãƒ‰": 11, "ã‚«ãƒ¡ã‚ª": 2, "ãƒ´ã‚£ãƒ³ãƒ†ãƒ¼ã‚¸": 14, "ã¾ã¨ã‚å£²ã‚Š": 14},
                "2025-09": {"ãƒã‚¤ãƒ–ãƒ©ãƒ³ãƒ‰": 68, "ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼/ã‚³ãƒ©ãƒœ": 52, "ãƒ‡ã‚¶ã‚¤ãƒŠãƒ¼ãƒ–ãƒ©ãƒ³ãƒ‰": 9, "ã‚«ãƒ¡ã‚ª": 3, "ãƒ´ã‚£ãƒ³ãƒ†ãƒ¼ã‚¸": 12, "ã¾ã¨ã‚å£²ã‚Š": 13},
                "2025-10": {"ãƒã‚¤ãƒ–ãƒ©ãƒ³ãƒ‰": 72, "ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼/ã‚³ãƒ©ãƒœ": 48, "ãƒ‡ã‚¶ã‚¤ãƒŠãƒ¼ãƒ–ãƒ©ãƒ³ãƒ‰": 10, "ã‚«ãƒ¡ã‚ª": 2, "ãƒ´ã‚£ãƒ³ãƒ†ãƒ¼ã‚¸": 11, "ã¾ã¨ã‚å£²ã‚Š": 15},
                "2025-11": {"ãƒã‚¤ãƒ–ãƒ©ãƒ³ãƒ‰": 78, "ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼/ã‚³ãƒ©ãƒœ": 55, "ãƒ‡ã‚¶ã‚¤ãƒŠãƒ¼ãƒ–ãƒ©ãƒ³ãƒ‰": 12, "ã‚«ãƒ¡ã‚ª": 3, "ãƒ´ã‚£ãƒ³ãƒ†ãƒ¼ã‚¸": 14, "ã¾ã¨ã‚å£²ã‚Š": 18},
                "2025-12": {"ãƒã‚¤ãƒ–ãƒ©ãƒ³ãƒ‰": 85, "ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼/ã‚³ãƒ©ãƒœ": 62, "ãƒ‡ã‚¶ã‚¤ãƒŠãƒ¼ãƒ–ãƒ©ãƒ³ãƒ‰": 14, "ã‚«ãƒ¡ã‚ª": 2, "ãƒ´ã‚£ãƒ³ãƒ†ãƒ¼ã‚¸": 16, "ã¾ã¨ã‚å£²ã‚Š": 20},
                "2026-01": {"ãƒã‚¤ãƒ–ãƒ©ãƒ³ãƒ‰": 50, "ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼/ã‚³ãƒ©ãƒœ": 45, "ãƒ‡ã‚¶ã‚¤ãƒŠãƒ¼ãƒ–ãƒ©ãƒ³ãƒ‰": 7, "ã‚«ãƒ¡ã‚ª": 2, "ãƒ´ã‚£ãƒ³ãƒ†ãƒ¼ã‚¸": 10, "ã¾ã¨ã‚å£²ã‚Š": 12},
            }
        };

        let currentExchangeRate = 155;
        let currentShipping = 2700;
        let currentFeeRate = 0.20;

        // ç‚ºæ›¿ãƒ¬ãƒ¼ãƒˆå–å¾—
        async function fetchExchangeRate() {
            const statusEl = document.getElementById('exchangeStatus');
            statusEl.textContent = 'å–å¾—ä¸­...';
            try {
                const response = await fetch('https://api.exchangerate-api.com/v4/latest/USD');
                const data = await response.json();
                const rate = data.rates.JPY;
                document.getElementById('exchangeRate').value = rate.toFixed(2);
                currentExchangeRate = rate;
                statusEl.textContent = `âœ“ ${new Date().toLocaleTimeString()} å–å¾—`;
                recalculate();
            } catch (error) {
                statusEl.textContent = 'å–å¾—å¤±æ•—';
                console.error('Exchange rate fetch failed:', error);
            }
        }

        // ä»•å…¥ä¸Šé™è¨ˆç®—
        function calculateBreakeven(priceUsd) {
            return priceUsd * currentExchangeRate * (1 - currentFeeRate) - currentShipping;
        }

        // å†è¨ˆç®—
        function recalculate() {
            currentExchangeRate = parseFloat(document.getElementById('exchangeRate').value) || 155;
            currentShipping = parseFloat(document.getElementById('shippingCost').value) || 2700;
            currentFeeRate = parseFloat(document.getElementById('feeRate').value) / 100 || 0.20;

            renderAllTables();
        }

        // ãƒ†ãƒ¼ãƒ–ãƒ«æç”»
        function renderTable(category, bodyId) {
            const data = analysisData.categories[category];
            if (!data) return;

            const tbody = document.getElementById(bodyId);
            tbody.innerHTML = '';

            data.rows.forEach(row => {
                const jpy = row.median_price * currentExchangeRate;
                const breakeven = calculateBreakeven(row.median_price);
                const searchQuery = encodeURIComponent(row.search_queries[0] || row.sub_category);
                const ebayQuery = encodeURIComponent(row.sub_category.replace(' - ', ' ') + ' brooch');

                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td><strong>${row.sub_category}</strong></td>
                    <td>${row.total_sales}</td>
                    <td>$${row.min_price.toFixed(0)}</td>
                    <td>$${row.max_price.toFixed(0)}</td>
                    <td>$${row.median_price.toFixed(0)}</td>
                    <td>Â¥${Math.round(jpy).toLocaleString()}</td>
                    <td class="${breakeven > 0 ? 'positive' : 'negative'}">Â¥${Math.round(breakeven).toLocaleString()}</td>
                    <td>
                        <a href="https://www.ebay.com/sch/i.html?_nkw=${ebayQuery}&LH_Sold=1&LH_Complete=1" target="_blank" class="link-btn link-ebay">eBay</a>
                        <a href="https://jp.mercari.com/search?keyword=${searchQuery}&status=on_sale" target="_blank" class="link-btn link-mercari">ãƒ¡ãƒ«ã‚«ãƒª</a>
                    </td>
                `;
                tbody.appendChild(tr);
            });
        }

        // ãŠã™ã™ã‚ãƒ†ãƒ¼ãƒ–ãƒ«æç”»
        function renderRecommendTable() {
            const tbody = document.getElementById('recommend-body');
            tbody.innerHTML = '';

            const categoryColors = {
                "ãƒã‚¤ãƒ–ãƒ©ãƒ³ãƒ‰": "#E91E63",
                "ãƒ‡ã‚¶ã‚¤ãƒŠãƒ¼ãƒ–ãƒ©ãƒ³ãƒ‰": "#9C27B0",
                "ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼/ã‚³ãƒ©ãƒœ": "#FF5722",
                "ã‚«ãƒ¡ã‚ª": "#795548",
                "ãƒ´ã‚£ãƒ³ãƒ†ãƒ¼ã‚¸": "#607D8B",
                "ã¾ã¨ã‚å£²ã‚Š": "#4CAF50"
            };

            analysisData.recommendations.forEach(row => {
                const breakeven = calculateBreakeven(row.median_price);
                const rankClass = row.rank <= 3 ? `rank-${row.rank}` : 'rank-other';
                const riskClass = row.risk_level === 'ä½' ? 'risk-low' : (row.risk_level === 'ä¸­' ? 'risk-mid' : 'risk-high');

                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td><span class="rank-badge ${rankClass}">${row.rank}</span></td>
                    <td><span class="category-badge" style="background:${categoryColors[row.main_category] || '#666'}">${row.main_category}</span></td>
                    <td><strong>${row.sub_category}</strong></td>
                    <td>${row.total_sales}</td>
                    <td>$${row.median_price.toFixed(0)}</td>
                    <td class="${breakeven > 0 ? 'positive' : 'negative'}">Â¥${Math.round(breakeven).toLocaleString()}</td>
                    <td><span class="${riskClass}">${row.risk_level}</span></td>
                    <td>${(row.score / 10000).toFixed(0)}ä¸‡</td>
                `;
                tbody.appendChild(tr);
            });
        }

        // å…¨ãƒ†ãƒ¼ãƒ–ãƒ«æç”»
        function renderAllTables() {
            renderTable('ãƒã‚¤ãƒ–ãƒ©ãƒ³ãƒ‰', 'highbrand-body');
            renderTable('ãƒ‡ã‚¶ã‚¤ãƒŠãƒ¼ãƒ–ãƒ©ãƒ³ãƒ‰', 'designer-body');
            renderTable('ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼/ã‚³ãƒ©ãƒœ', 'character-body');
            renderTable('ã‚«ãƒ¡ã‚ª', 'cameo-body');
            renderTable('ãƒ´ã‚£ãƒ³ãƒ†ãƒ¼ã‚¸', 'vintage-body');
            renderTable('ã¾ã¨ã‚å£²ã‚Š', 'bundle-body');
            renderRecommendTable();
        }

        // ãƒ†ãƒ¼ãƒ–ãƒ«ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
        function filterTable(input, tableId) {
            const filter = input.value.toLowerCase();
            const table = document.getElementById(tableId);
            const rows = table.getElementsByTagName('tr');

            for (let i = 1; i < rows.length; i++) {
                const text = rows[i].textContent.toLowerCase();
                rows[i].style.display = text.includes(filter) ? '' : 'none';
            }
        }

        // ã‚¿ãƒ–åˆ‡æ›¿
        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', () => {
                document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                tab.classList.add('active');
                document.getElementById('tab-' + tab.dataset.tab).classList.add('active');
            });
        });

        // ãƒ†ãƒ¼ãƒåˆ‡æ›¿
        function toggleTheme() {
            const html = document.documentElement;
            const current = html.getAttribute('data-theme');
            const next = current === 'dark' ? 'light' : 'dark';
            html.setAttribute('data-theme', next);
            localStorage.setItem('theme', next);
            renderCharts();
        }

        // ãƒ†ãƒ¼ãƒåˆæœŸåŒ–
        function initTheme() {
            const saved = localStorage.getItem('theme');
            if (saved === 'dark') {
                document.documentElement.setAttribute('data-theme', 'dark');
            }
        }

        // ã‚°ãƒ©ãƒ•æç”»
        function renderCharts() {
            const isDark = document.documentElement.getAttribute('data-theme') === 'dark';
            const textColor = isDark ? '#eaeaea' : '#333';
            const bgColor = isDark ? '#0f3460' : '#fff';

            // ã‚«ãƒ†ã‚´ãƒªåˆ¥è²©å£²æ•°
            const catLabels = ['ãƒã‚¤ãƒ–ãƒ©ãƒ³ãƒ‰', 'ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼/ã‚³ãƒ©ãƒœ', 'ã¾ã¨ã‚å£²ã‚Š', 'ãƒ´ã‚£ãƒ³ãƒ†ãƒ¼ã‚¸', 'ãƒ‡ã‚¶ã‚¤ãƒŠãƒ¼ãƒ–ãƒ©ãƒ³ãƒ‰', 'ã‚«ãƒ¡ã‚ª'];
            const catValues = [808, 571, 187, 171, 123, 33];
            const catColors = ['#E91E63', '#FF5722', '#4CAF50', '#607D8B', '#9C27B0', '#795548'];

            Plotly.newPlot('chartCategorySales', [{
                type: 'bar',
                y: catLabels,
                x: catValues,
                orientation: 'h',
                marker: { color: catColors }
            }], {
                title: { text: 'ã‚«ãƒ†ã‚´ãƒªåˆ¥è²©å£²æ•°', font: { color: textColor } },
                paper_bgcolor: bgColor,
                plot_bgcolor: bgColor,
                font: { color: textColor },
                margin: { l: 120, r: 20, t: 40, b: 40 },
                xaxis: { gridcolor: isDark ? '#3a3a5c' : '#e0e0e0' }
            }, { responsive: true });

            // ã‚«ãƒ†ã‚´ãƒªåˆ¥ã‚·ã‚§ã‚¢
            Plotly.newPlot('chartCategoryShare', [{
                type: 'pie',
                labels: catLabels,
                values: catValues,
                marker: { colors: catColors },
                textinfo: 'label+percent'
            }], {
                title: { text: 'ã‚«ãƒ†ã‚´ãƒªåˆ¥ã‚·ã‚§ã‚¢', font: { color: textColor } },
                paper_bgcolor: bgColor,
                font: { color: textColor },
                margin: { l: 20, r: 20, t: 40, b: 40 }
            }, { responsive: true });

            // ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼/ã‚³ãƒ©ãƒœè©³ç´°
            const charLabels = ['ãƒ—ãƒªã‚­ãƒ¥ã‚¢', 'Ado-ãƒ¢ãƒŠãƒªã‚¶', 'æ‘ä¸Šéš†-æ¡œ', 'Ado-Hibana', 'Ado-ãã®ä»–', 'ã‚»ãƒ¼ãƒ©ãƒ¼ãƒ ãƒ¼ãƒ³', 'ã‚µãƒ³ãƒªã‚ª', 'DMC', 'ãƒ‡ã‚£ã‚ºãƒ‹ãƒ¼', 'Ado-ã‚ˆã ã‹'];
            const charValues = [94, 87, 67, 46, 45, 38, 27, 26, 25, 19];

            Plotly.newPlot('chartBrandSales', [{
                type: 'bar',
                y: charLabels,
                x: charValues,
                orientation: 'h',
                marker: { color: '#FF5722' }
            }], {
                title: { text: 'ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼/ã‚³ãƒ©ãƒœ TOP10', font: { color: textColor } },
                paper_bgcolor: bgColor,
                plot_bgcolor: bgColor,
                font: { color: textColor },
                margin: { l: 120, r: 20, t: 40, b: 40 },
                xaxis: { gridcolor: isDark ? '#3a3a5c' : '#e0e0e0' }
            }, { responsive: true });

            // ä¾¡æ ¼å¸¯åˆ†å¸ƒ
            const priceRanges = ['~$50', '$50-100', '$100-200', '$200-500', '$500+'];
            const priceCounts = [320, 450, 380, 420, 188];

            Plotly.newPlot('chartPriceDistribution', [{
                type: 'bar',
                x: priceRanges,
                y: priceCounts,
                marker: { color: '#667eea' }
            }], {
                title: { text: 'ä¾¡æ ¼å¸¯åˆ†å¸ƒ', font: { color: textColor } },
                paper_bgcolor: bgColor,
                plot_bgcolor: bgColor,
                font: { color: textColor },
                margin: { l: 50, r: 20, t: 40, b: 40 },
                yaxis: { gridcolor: isDark ? '#3a3a5c' : '#e0e0e0' }
            }, { responsive: true });

            // æœˆåˆ¥å£²ä¸Šæ¨ç§»
            const months = Object.keys(analysisData.monthly_sales);
            const traces = [];
            const categoryList = ['ãƒã‚¤ãƒ–ãƒ©ãƒ³ãƒ‰', 'ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼/ã‚³ãƒ©ãƒœ', 'ãƒ‡ã‚¶ã‚¤ãƒŠãƒ¼ãƒ–ãƒ©ãƒ³ãƒ‰', 'ãƒ´ã‚£ãƒ³ãƒ†ãƒ¼ã‚¸', 'ã¾ã¨ã‚å£²ã‚Š', 'ã‚«ãƒ¡ã‚ª'];
            const colors = ['#E91E63', '#FF5722', '#9C27B0', '#607D8B', '#4CAF50', '#795548'];

            categoryList.forEach((cat, i) => {
                traces.push({
                    name: cat,
                    x: months,
                    y: months.map(m => analysisData.monthly_sales[m][cat] || 0),
                    type: 'bar',
                    marker: { color: colors[i] }
                });
            });

            Plotly.newPlot('chartMonthlySales', traces, {
                title: { text: 'æœˆåˆ¥å£²ä¸Šæ¨ç§»ï¼ˆç©ã¿ä¸Šã’ï¼‰', font: { color: textColor } },
                barmode: 'stack',
                paper_bgcolor: bgColor,
                plot_bgcolor: bgColor,
                font: { color: textColor },
                margin: { l: 50, r: 20, t: 40, b: 60 },
                xaxis: { tickangle: -45 },
                yaxis: { gridcolor: isDark ? '#3a3a5c' : '#e0e0e0' },
                legend: { orientation: 'h', y: -0.2 }
            }, { responsive: true });
        }

        // åˆæœŸåŒ–
        initTheme();
        renderAllTables();
        renderCharts();
    </script>
</body>
</html>
